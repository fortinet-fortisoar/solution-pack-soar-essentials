{
  "type": "workflow_collections",
  "data": [
    {
      "@context": "/api/3/contexts/WorkflowCollection",
      "@type": "WorkflowCollection",
      "name": "03 - Enrich",
      "description": null,
      "visible": true,
      "image": null,
      "uuid": "bea2a6c5-c98d-4ee5-befd-9fbfd11c2a32",
      "id": 18,
      "createDate": 1649319945.015677,
      "modifyDate": 1649319945.015677,
      "deletedAt": null,
      "importedBy": [
        {
          "apiName": "sOARFramework",
          "name": "SOAR Framework",
          "version": "1.0.0"
        }
      ],
      "recordTags": [],
      "workflows": [
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Indicator (Type File - MD5) - Get Reputation",
          "aliasName": null,
          "tag": "#Subroutine",
          "description": "Get Reputation of File identified by MD5 hash",
          "isActive": true,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [
            "indicator_value"
          ],
          "synchronous": false,
          "lastModifyDate": 1649319945,
          "collection": "/api/3/workflow_collections/bea2a6c5-c98d-4ee5-befd-9fbfd11c2a32",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/f02f1e12-1802-4262-bdc4-ba2e4ccd35ea",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Configuration",
              "description": null,
              "arguments": {
                "indicator_value": "{{vars.input.params['indicator_value'] | ternary(vars.input.params['indicator_value'],vars.input.records[0].value) }}",
                "reputation_threshold": "5",
                "foundAnomaliReputation": "false"
              },
              "status": null,
              "top": "350",
              "left": "775",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "03b1dad3-ff27-45c2-9d89-55dece9adb7b"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Reputation from AlienVault OTX",
              "description": null,
              "arguments": {
                "name": "AlienVault-OTX",
                "config": "3d96900a-f870-4ac6-94d0-00865dbaf86f",
                "params": {
                  "page": 1,
                  "limit": 5,
                  "user_text": "{{vars.indicator_value}}"
                },
                "version": "1.0.0",
                "connector": "alienvault-otx",
                "operation": "search_pulses",
                "ignore_errors": true,
                "operationTitle": "Search Pulses",
                "step_variables": {
                  "foundAVReputation": "{{ ( vars.result.data.results and vars.result.data.results|json_query(\"[*].tags[]\") | length > 0 ) | ternary(true,false) }}"
                }
              },
              "status": null,
              "top": "190",
              "left": "2725",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "04d90782-8806-4825-a0bd-c7377273cbab"
            },
            {
              "@type": "WorkflowStep",
              "name": "Update Record",
              "description": null,
              "arguments": {
                "resource": {
                  "__link": {
                    "recordTags": "{% if vars.foundAVReputation %}{{(vars.steps.Get_Reputation_from_AlienVault_OTX.data.results | json_query(\"[*].tags[]\") | unique | string).replace(\"[\",\"\").replace(\"]\",\"\").replace(\"?\",\"\").replace(\"\\'\",\"\").replace(\"#\",\"\").replace(\"\\\"\",\"\").replace(\"/\",\"\").replace(\"*\",\"\")}}{%endif%}"
                  },
                  "reputation": "{{vars.Reputation_Type_IRI}}",
                  "description": "{{vars.steps.Enrichment_Summary.data['formatted_string']}}\n"
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "{{vars.input.records[0]['@id']}}",
                "__recommend": [],
                "collectionType": "/api/3/indicators",
                "fieldOperation": {
                  "recordTags": "Append"
                },
                "step_variables": []
              },
              "status": null,
              "top": "350",
              "left": "4675",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928722",
              "uuid": "48414e38-d18e-4bfb-a9a4-389622481e7c"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": "Indicator reputation is set as 'TBD' by 'Create and Link Indicator' utility playbook. We can ignore those indicators when triggering this PB",
              "arguments": {
                "resource": "indicators",
                "resources": [
                  "indicators"
                ],
                "step_variables": {
                  "input": {
                    "params": {
                      "indicator_value": "{{ vars.indicator_value }}"
                    },
                    "records": [
                      "{{vars.input.records[0]}}"
                    ]
                  }
                },
                "fieldbasedtrigger": {
                  "sort": [],
                  "limit": 30,
                  "logic": "AND",
                  "filters": [
                    {
                      "type": "object",
                      "field": "typeofindicator",
                      "value": "/api/3/picklists/0ca054f2-d923-4992-a4a7-c516e6df281e",
                      "_value": {
                        "@id": "/api/3/picklists/0ca054f2-d923-4992-a4a7-c516e6df281e",
                        "itemValue": "FileHash-MD5"
                      },
                      "operator": "eq"
                    },
                    {
                      "type": "object",
                      "field": "indicatorStatus",
                      "value": "/api/3/picklists/4218cb58-4de5-4eff-ad08-185d36ef9bab",
                      "_value": {
                        "@id": "/api/3/picklists/4218cb58-4de5-4eff-ad08-185d36ef9bab",
                        "itemValue": "Whitelisted"
                      },
                      "operator": "neq"
                    },
                    {
                      "logic": "OR",
                      "filters": [
                        {
                          "type": "object",
                          "field": "reputation",
                          "value": "true",
                          "_value": {
                            "@id": "true",
                            "display": "",
                            "itemValue": ""
                          },
                          "operator": "isnull"
                        },
                        {
                          "type": "object",
                          "field": "reputation",
                          "value": "/api/3/picklists/ae98ebc6-beef-4882-9980-1d88fc6d87cd",
                          "_value": {
                            "@id": "/api/3/picklists/ae98ebc6-beef-4882-9980-1d88fc6d87cd",
                            "itemValue": "TBD"
                          },
                          "operator": "eq"
                        }
                      ]
                    }
                  ]
                }
              },
              "status": null,
              "top": "430",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/ea155646-3821-4542-9702-b246da430a8d",
              "uuid": "f02f1e12-1802-4262-bdc4-ba2e4ccd35ea"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get File Reputation from Symantec Deepsight Intelligence",
              "description": null,
              "arguments": {
                "name": "Symantec DeepSight Intelligence",
                "config": "8582d1ad-6584-4d14-a0b4-d8571b09b8b2",
                "params": {
                  "filehash": "{{vars.indicator_value}}"
                },
                "version": "1.0.1",
                "connector": "symantec-deepsight-intelligence",
                "operation": "filehash_reputation",
                "ignore_errors": true,
                "operationTitle": "Get File Reputation",
                "step_variables": {
                  "foundDeepsightReputation": "{{ ( vars.result.data.result and vars.result.data.result.reputation != \"Unknown Reputation\" ) | ternary(true,false) }}"
                }
              },
              "status": null,
              "top": "350",
              "left": "2725",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "830d4f05-d741-4704-b9d4-6c3dd7fe9267"
            },
            {
              "@type": "WorkflowStep",
              "name": "Enrichment Summary",
              "description": null,
              "arguments": {
                "params": {
                  "value": "{{vars.steps.Compute_VT_Summary.data['formatted_string']}}\n\n{{vars.steps.Compute_Anomali_Summary.data['formatted_string']}}\n\n{{vars.steps.Compute_AV_OTX_Summary.data['formatted_string']}}\n\n {{vars.steps.Compute_Symantec_Summary.data['formatted_string']}}\n\n{{vars.steps.Compute_Additional_Summary.data['formatted_string']}}\n"
                },
                "version": "3.1.1",
                "connector": "cyops_utilities",
                "operation": "format_richtext",
                "operationTitle": "Utils: Format as RichText",
                "step_variables": []
              },
              "status": null,
              "top": "270",
              "left": "4025",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "516c492c-09b0-4b4e-84b2-ce403e9c2211"
            },
            {
              "@type": "WorkflowStep",
              "name": "Compute Symantec Summary",
              "description": null,
              "arguments": {
                "params": {
                  "value": "<p>{% if vars.foundDeepsightReputation%}</p>\n<div class=\"font-size-17 ng-binding padding-left-sm\"><strong>Symantec Deepsight Intelligence</strong></div>\n\n<div class=\"card-container-body\" style=\"width: 200px;\">\n<div class=\"card-number padding-top-sm padding-bottom-sm\">\n <div class=\"line-height-1\"> <a href=\"https://mss.symantec.com/PortalNextgen/Research/md5?Hash={{vars.indicator_value}}\" target=\"_blank\" rel=\"noopener noreferrer\"> <span class=\"card-count\">{{vars.steps.Get_File_Reputation_from_Symantec_Deepsight_Intelligence.data.result.reputation}}</span> </a>\n<div class=\"font-size-14 font-weight-normall padding-top-sm padding-bottom-sm\">Detection: {{vars.steps.Get_File_Reputation_from_Symantec_Deepsight_Intelligence.data.result.detectionName}}</div>\n</div>\n</div>\n<p>{% endif %}</p>"
                },
                "version": "3.0.3",
                "connector": "cyops_utilities",
                "operation": "format_richtext",
                "operationTitle": "Utils: Format as RichText",
                "step_variables": []
              },
              "status": null,
              "top": "350",
              "left": "3050",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "ae3d2272-580d-47a5-806f-f077c8576936"
            },
            {
              "@type": "WorkflowStep",
              "name": "Compute AV OTX Summary",
              "description": null,
              "arguments": {
                "params": {
                  "value": "{% if vars.foundAVReputation %}\n<div class=\"font-size-11 ng-binding padding-bottom-sm\"><h4 style=\"background: #404142;padding: 5px;text-align: left;color: orange;background: black;\">Alien Vault Summary</h4></div>\n<table style=\"width: 506px; border-color: #ffffff;\" border=\"1\">\n<tbody>\n<tr>\n<td style=\"width: 45px;font-size:16px;font-weight: normal\"><strong>Tags</strong></td>\n<td><div class=\"font-size-14 font-weight-normal\">{{(vars.steps.Get_Reputation_from_AlienVault_OTX.data.results | json_query(\"[*].tags[]\") | unique | string).replace(\"[\",\"\").replace(\"]\",\"\")}}</div></td>\n</tr>\n</tbody>\n</table>\n<p>{% endif %}</p>"
                },
                "version": "3.1.1",
                "connector": "cyops_utilities",
                "operation": "format_richtext",
                "operationTitle": "Utils: Format as RichText",
                "step_variables": []
              },
              "status": null,
              "top": "190",
              "left": "3050",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "69488674-3e49-49dd-95b8-32a3bd8e9a20"
            },
            {
              "@type": "WorkflowStep",
              "name": "Compute Anomali Summary",
              "description": null,
              "arguments": {
                "params": {
                  "value": "<p>{% if vars.foundAnomaliReputation %}</p>\n<div class=\"font-size-11 ng-binding padding-bottom-sm\"><h4 style=\"background: #404142;padding: 5px;text-align: left;color: orange;background: black;\"> Anomali Threatstream Detection Summary</h4></div>\n<div class=\"card-container-body\" style=\"width: 170px;\">\n{%if vars.steps.Get_File_Reputation_from_Anomali.data.objects[0].threatscore !=0 %}\n<div class=\"card-number padding-top-sm padding-bottom-sm\" style=\" border-left: 5px solid red;background:#141b23\">\n <div class=\"line-height-1\"><a href=\"https://ui.threatstream.com/detail/domain/{{vars.indicator_value}}\" target=\"_blank\" rel=\"noopener noreferrer\" class=\"font-size-8em\"> <span class=\"card-count\">{{vars.steps.Get_File_Reputation_from_Anomali.data.objects[0].threatscore}} </span> </a>\n<div class=\"font-size-14 font-weight-normall padding-top-sm padding-bottom-sm\">Severity: {{vars.steps.Get_File_Reputation_from_Anomali.data.objects[0].meta.severity}}</div>\n{%else%}\n<div class=\"card-number padding-top-sm padding-bottom-sm\" style=\" border-left: 5px solid red\">\n <div class=\"line-height-1\"><a href=\"https://ui.threatstream.com/detail/domain/{{vars.indicator_value}}\" target=\"_blank\" rel=\"noopener noreferrer\" class=\"font-size-8em\"> <span class=\"card-count\">{{vars.steps.Get_File_Reputation_from_Anomali.data.objects[0].threatscore}} </span> </a>\n<div class=\"font-size-14 font-weight-normall padding-top-sm padding-bottom-sm\">Severity: {{vars.steps.Get_File_Reputation_from_Anomali.data.objects[0].meta.severity}}{% endif %}\n</div>\n\n</div>\n</div>\n<p>{% endif %}</p>\n"
                },
                "version": "3.1.1",
                "connector": "cyops_utilities",
                "operation": "format_richtext",
                "operationTitle": "Utils: Format as RichText",
                "step_variables": []
              },
              "status": null,
              "top": "30",
              "left": "3050",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "b796e9df-d096-4f97-97cb-eca40a7543b6"
            },
            {
              "@type": "WorkflowStep",
              "name": "Summary",
              "description": null,
              "arguments": {
                "reputation": "{{vars.Reputation_Type_Text}}",
                "reputation_iri": "{{vars.Reputation_Type_IRI}}",
                "enrichment_summary": "{{vars.steps.Enrichment_Summary.data['formatted_string']}}"
              },
              "status": null,
              "top": "190",
              "left": "4675",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "71ed97ab-6f2e-4f25-a648-c09d3f181698"
            },
            {
              "@type": "WorkflowStep",
              "name": "Upon Create",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "option": "Referenced",
                    "step_iri": "/api/3/workflow_steps/71ed97ab-6f2e-4f25-a648-c09d3f181698",
                    "condition": "{{ vars.input.params['indicator_value'] | length > 0 }}"
                  },
                  {
                    "option": "Upon Create",
                    "default": true,
                    "step_iri": "/api/3/workflow_steps/48414e38-d18e-4bfb-a9a4-389622481e7c"
                  }
                ]
              },
              "status": null,
              "top": "270",
              "left": "4350",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "uuid": "1d15fc8a-5ee1-4abd-affc-be2fedfaf9e5"
            },
            {
              "@type": "WorkflowStep",
              "name": "Compute VT Summary",
              "description": null,
              "arguments": {
                "params": {
                  "value": "<div class=\"font-size-11 ng-binding padding-bottom-sm\"><h4 style=\"background: #404142;padding: 5px;text-align: left;color: orange;background: black;\"> VirusTotal Detection Summary</h4></div>\n<table style=\"border-color: #04080c;\" border=\"1\" class=\"font-normal\">\n<tr><td>\n<table style=\"color:white;font-size:11;\" >\n<tr>\n<td>\n<html>\n  <head>\n    <title>Title of the document</title>\n    <style>\n      span.circle {\n        background: #2f3f51;\n        border-radius: 50%;\n        -moz-border-radius: 50%;\n        -webkit-border-radius: 50%;\n        display: inline-block;\n         font-weight: bold;\n        line-height: 100px;\n        margin-right: 5px;\n        text-align: center;\n        width: 100px;\n      font-size:15px;\n     border-color: Black;\n      }\n    </style>\n  </head>\n  <body><span class=\"circle\"><i style=\"font-size:25px;color:red \">\n   {{vars.last_analysis_stats.malicious}}</i>/{{(vars.last_analysis_stats.values() | list ) [0:6] | sum}}</span>\n  </body>\n</html>\n</td>\n\n<td>\n<div class=\"font-size-14 ng-binding\">Malicious</div>\n<div class=\"card-container-body\" style=\"width: 100px;font-size:46px;\">\n<div class=\"card-number\"; style=\"font-size:45px;  border-left: 5px solid red;background:#141b23\">{{vars.last_analysis_stats.malicious}}</div>\n</div>\n</td>\n<td>\n<div class=\"font-size-14 ng-binding\">Suspicious</div>\n<div class=\"card-container-body\" style=\"width: 100px;\">\n<div class=\"card-number\" style=\"font-size:45px;  border-left: 5px solid orange; background:#141b23\">{{vars.last_analysis_stats.suspicious}}</div>\n</div>\n</td>\n<td>\n<div class=\"font-size-14 ng-binding\">Harmless</div>\n<div class=\"card-container-body\" style=\"width: 100px;\">\n<div class=\"card-number\" style=\"font-size:45px;  border-left: 5px solid green; background:#141b23\">{{vars.last_analysis_stats.harmless}}</div></div>\n</td>\n</tr>\n</table>\n\n<td style=\"vertical-align:top\">\n<table style=\"background-color: #1b2430; color:white;font-size:16;\" class=\"margin-10\">\n<tr>\n<div class=\"margin-top-md\">\n<i class=\"fa fa-group margin-left-md margin-right-sm\"></i> Community Votes</div>\n\n<td style=\"width: 100px;text-align: center;background:#141b23\">\n<i class=\"\tfa fa-thumbs-o-up\" style=\"font-size:25px;color:green\"></i>\n<div class=\"font-size-11 ng-binding\">Harmless {{vars.community_votes.harmless}}</div>\n</td>\n<td style=\"width: 100px;text-align: center;background:#141b23\">\n<i class=\"fa fa-thumbs-o-down\" style=\"font-size:25px;color:red \"></i>\n<div class=\"font-size-11 ng-binding\">Malicious {{vars.community_votes.malicious}}</div>\n</td>\n</tr>\n</table>\n</div>\n</td>\n</tr>\n</table>"
                },
                "version": "3.1.1",
                "connector": "cyops_utilities",
                "operation": "format_richtext",
                "operationTitle": "Utils: Format as RichText",
                "step_variables": []
              },
              "status": null,
              "top": "510",
              "left": "1425",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "dcd08fa4-38c5-47dd-b8e8-e82562bdd449"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get File Reputation from Anomali",
              "description": null,
              "arguments": {
                "name": "Anomali ThreatStream",
                "config": "8827ae00-b86a-4ed4-aa2c-deae42b1d993",
                "params": {
                  "value": "{{vars.indicator_value}}",
                  "validation": false,
                  "filter_option": "Exact",
                  "record_number": "Fetch All Records"
                },
                "version": "2.0.0",
                "connector": "threatstream",
                "operation": "file_reputation",
                "ignore_errors": true,
                "operationTitle": "Get File Reputation",
                "step_variables": {
                  "foundAnomaliReputation": "{{ ( vars.result.data.objects and vars.result.data.objects | length > 0 ) | ternary(true,false) }}"
                }
              },
              "status": null,
              "top": "30",
              "left": "2725",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "f42c0116-0da6-4a59-aefa-2f78030977a3"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get File Reputation from VT",
              "description": null,
              "arguments": {
                "name": "VirusTotal",
                "config": "4a22a2c4-a1b5-4b9d-ba9b-df87a8cebce9",
                "params": {
                  "file_hash": "{{vars.indicator_value}}"
                },
                "version": "2.0.0",
                "connector": "virustotal",
                "operation": "file_reputation",
                "operationTitle": "Get File Reputation",
                "pickFromTenant": false,
                "step_variables": {
                  "tags": "{{(vars.result.data.attributes.tags  | unique | string).replace(\"(\",\"\").replace(\")\",\"\").replace(\"[\",\"\").replace(\"]\",\"\")}}",
                  "community_votes": "{{vars.result.data.attributes['total_votes']}}",
                  "sandbox_verdict": "[]",
                  "last_analysis_stats": "{{vars.result.data.attributes['last_analysis_stats']}}"
                }
              },
              "status": null,
              "top": "510",
              "left": "1100",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "bd567c84-e78c-4154-ac43-9906d66a1539"
            },
            {
              "@type": "WorkflowStep",
              "name": "Is Malicious",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "option": "Malicious",
                    "step_iri": "/api/3/workflow_steps/2fd0a162-3a5c-4618-b08e-be0275c1a4a1",
                    "condition": "{{ vars.last_analysis_stats.malicious > 0 }}",
                    "step_name": "Set Malicious"
                  },
                  {
                    "option": "Safe",
                    "step_iri": "/api/3/workflow_steps/b7a048ad-0c0a-45ab-a980-4012bcdb2c67",
                    "condition": "{{ vars.last_analysis_stats.harmless > vars.last_analysis_stats.undetected }}",
                    "step_name": "Set Good"
                  },
                  {
                    "option": "No Reputation",
                    "default": true,
                    "step_iri": "/api/3/workflow_steps/daf2da7a-468d-4ee6-9adc-36f12e763500",
                    "step_name": "Set No Reputation"
                  },
                  {
                    "option": "Suspicious",
                    "step_iri": "/api/3/workflow_steps/fd4e6cf7-296b-4d6f-a1e7-8028f144013f",
                    "condition": "{{ vars.last_analysis_stats.suspicious > 0 }}",
                    "step_name": "Set Suspicious"
                  }
                ]
              },
              "status": null,
              "top": "260",
              "left": "3380",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "uuid": "458a2b1d-7dd1-499a-85c6-d1842508ca0c"
            },
            {
              "@type": "WorkflowStep",
              "name": "Set Suspicious",
              "description": null,
              "arguments": {
                "Reputation_Type_IRI": "{{(\"IndicatorReputation\" | picklist(\"Suspicious\"))[\"@id\"]}}",
                "Reputation_Type_Text": "Suspicious"
              },
              "status": null,
              "top": "590",
              "left": "3700",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "fd4e6cf7-296b-4d6f-a1e7-8028f144013f"
            },
            {
              "@type": "WorkflowStep",
              "name": "Set No Reputation",
              "description": null,
              "arguments": {
                "Reputation_Type_IRI": "{{(\"IndicatorReputation\" | picklist(\"No Reputation Available\"))[\"@id\"]}}",
                "Reputation_Type_Text": "No Reputation Available"
              },
              "status": null,
              "top": "430",
              "left": "3700",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "daf2da7a-468d-4ee6-9adc-36f12e763500"
            },
            {
              "@type": "WorkflowStep",
              "name": "Set Good",
              "description": null,
              "arguments": {
                "Reputation_Type_IRI": "{{(\"IndicatorReputation\" | picklist(\"Good\"))[\"@id\"]}}",
                "Reputation_Type_Text": "Good"
              },
              "status": null,
              "top": "270",
              "left": "3700",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "b7a048ad-0c0a-45ab-a980-4012bcdb2c67"
            },
            {
              "@type": "WorkflowStep",
              "name": "Set Malicious",
              "description": null,
              "arguments": {
                "Reputation_Type_IRI": "{{(\"IndicatorReputation\" | picklist(\"Malicious\"))[\"@id\"]}}",
                "Reputation_Type_Text": "Malicious"
              },
              "status": null,
              "top": "110",
              "left": "3700",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "2fd0a162-3a5c-4618-b08e-be0275c1a4a1"
            },
            {
              "@type": "WorkflowStep",
              "name": "Compute Basic Properties",
              "description": null,
              "arguments": {
                "params": {
                  "data": "{{vars.steps.Get_File_Reputation_from_VT.data.attributes}}",
                  "styling": true,
                  "row_fields": "['md5','sha256','sha1','magic','type_tag','type_extension','type_description']",
                  "table_style": "{ 'width':'auto','font':'10px;'}"
                },
                "version": "3.1.2",
                "connector": "cyops_utilities",
                "operation": "json_to_html",
                "operationTitle": "Utils: Convert JSON into a HTML Table",
                "step_variables": []
              },
              "status": null,
              "top": "510",
              "left": "1750",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "85ef1e60-c531-4123-bba2-de1e9d7bf132"
            },
            {
              "@type": "WorkflowStep",
              "name": "Compute Additional Summary",
              "description": null,
              "arguments": {
                "params": {
                  "value": "<div class=\"font-size-11 ng-binding padding-bottom-sm\"><h4 style=\"background: #404142;padding: 5px;text-align: left;color: orange;background: black;\"> Additional Information</h4></div>\n\n<p>{% if (vars.tags | length > 0) %}</p>\n<div class=\"font-size-17 margin-top-12 padding-bottom-sm padding-left-sm padding-bottom-lg\"><strong>Virustotal Tags</strong></div>\n<table style=\"width: 506px; border-color: #ffffff;\" border=\"1\">\n<tbody>\n<tr>\n<td style=\"width: 45px;font-size:16px;font-weight: normal\"><strong>Tags</strong></td>\n<td> <div class=\"font-size-14 font-weight-normal\">{{(vars.tags| string).replace(\"(\",\"\").replace(\")\",\"\")}}</div></td>\n</tr>\n</tbody>\n</table>\n<p>{% endif %}</p>\n\n<br>\n\n<div style=\"white-space:nowrap;width:auto;display: flex;gap: 10px;\">\n{%if (vars.steps.Get_File_Reputation_from_VT.data.attributes.signature_info != None and vars.steps.Get_File_Reputation_from_VT.data.attributes.signature_info)%}<div><div class=\"font-size-17 margin-top-12 padding-bottom-md padding-left-sm\"><strong>Signature Information</strong></div>\n{{vars.steps.Compute_VT_Signature_Info.data}}\n</div>{%endif%}\n\n{%if (vars.sandbox_verdict != None and vars.sandbox_verdict) %}\n<div><div class=\"font-size-17 margin-top-12 padding-bottom-md padding-left-sm\"><strong>Sandbox Summary</strong></div>{{vars.steps.Compute_Sandbox_Verdict_from_VT.data}}\n</div>{%endif%}\n</div>\n\n\n<div class=\"font-size-17 margin-top-12 padding-bottom-sm padding-left-sm\"><strong>File Basic Properties</strong></div>\n{{vars.steps.Compute_Basic_Properties.data}}"
                },
                "version": "3.1.2",
                "connector": "cyops_utilities",
                "operation": "format_richtext",
                "operationTitle": "Utils: Format as RichText (Markdown)",
                "step_variables": []
              },
              "status": null,
              "top": "510",
              "left": "3050",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "2bc757fb-309e-4bd1-9f68-542509b94e70"
            },
            {
              "@type": "WorkflowStep",
              "name": "Compute VT Signature Info",
              "description": null,
              "arguments": {
                "when": "{{(vars.steps.Get_File_Reputation_from_VT.data.attributes.signature_info != None and vars.steps.Get_File_Reputation_from_VT.data.attributes.signature_info)}}",
                "params": {
                  "data": "{{vars.steps.Get_File_Reputation_from_VT.data.attributes.signature_info}}",
                  "styling": true,
                  "row_fields": "",
                  "table_style": "{ 'width':'auto','font':'10px;'}"
                },
                "version": "3.1.2",
                "connector": "cyops_utilities",
                "operation": "json_to_html",
                "operationTitle": "Utils: Convert JSON into a HTML Table",
                "step_variables": []
              },
              "status": null,
              "top": "510",
              "left": "2075",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "685c2461-f587-4aea-864b-5f688bdfdf47"
            },
            {
              "@type": "WorkflowStep",
              "name": "Compute Sandbox Verdict from VT",
              "description": null,
              "arguments": {
                "when": "{{(vars.sandbox_verdict != None and vars.sandbox_verdict)}}",
                "params": {
                  "data": "{{vars.sandbox_verdict}}",
                  "styling": true,
                  "row_fields": "['sandbox_name','category','confidence']",
                  "table_style": "{ 'width':'auto','font':'10px;'}"
                },
                "version": "3.1.2",
                "connector": "cyops_utilities",
                "operation": "json_to_html",
                "ignore_errors": true,
                "operationTitle": "Utils: Convert JSON into a HTML Table",
                "step_variables": []
              },
              "status": null,
              "top": "510",
              "left": "2725",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "03182d2e-c087-4a89-a867-1e132e9f7e0d"
            },
            {
              "@type": "WorkflowStep",
              "name": "sandbox_detection",
              "description": null,
              "arguments": {
                "sandbox_detection_VT": "{%if vars.steps.Get_File_Reputation_from_VT.data.attributes.sandbox_verdicts%}\n{% for key,value in vars.steps.Get_File_Reputation_from_VT.data.attributes.sandbox_verdicts.items() %}{{vars.sandbox_verdict.append(value)}}\n{%endfor%}\n{%endif%}"
              },
              "status": null,
              "top": "510",
              "left": "2400",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "62a0342f-5907-4f8e-9cda-168ffc3a1e7f"
            },
            {
              "@type": "WorkflowStep",
              "name": "Is Dedicated Tenant Record",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "option": "Yes, Enrich at Tenant Node",
                    "step_iri": "/api/3/workflow_steps/cb74cfa6-3bd1-4726-8d8e-ebc77ce81edf",
                    "condition": "{{ 'tenant' in vars.input.records[0] and vars.input.records[0].tenant.isDedicated and vars.input.records[0].tenant.role != 'self' }}",
                    "step_name": "Exit"
                  },
                  {
                    "option": "No, Enrich Here",
                    "default": true,
                    "step_iri": "/api/3/workflow_steps/03b1dad3-ff27-45c2-9d89-55dece9adb7b",
                    "step_name": "Configuration"
                  }
                ]
              },
              "status": null,
              "top": "430",
              "left": "450",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "uuid": "9cbb853e-78ba-467d-b91d-6ade7dbf491d"
            },
            {
              "@type": "WorkflowStep",
              "name": "Exit",
              "description": null,
              "arguments": {
                "params": [],
                "version": "3.2.1",
                "connector": "cyops_utilities",
                "operation": "no_op",
                "operationTitle": "Utils: No Operation",
                "step_variables": []
              },
              "status": null,
              "top": "510",
              "left": "775",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "cb74cfa6-3bd1-4726-8d8e-ebc77ce81edf"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Configuration -> Get File Reputation from Anomali",
              "targetStep": "/api/3/workflow_steps/f42c0116-0da6-4a59-aefa-2f78030977a3",
              "sourceStep": "/api/3/workflow_steps/03b1dad3-ff27-45c2-9d89-55dece9adb7b",
              "label": null,
              "isExecuted": false,
              "uuid": "19345514-f4b7-4431-b387-479fd0ac9fc6"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get File Reputation from Symantec Deepsight Intelligence -> Compute Symantec Summary",
              "targetStep": "/api/3/workflow_steps/ae3d2272-580d-47a5-806f-f077c8576936",
              "sourceStep": "/api/3/workflow_steps/830d4f05-d741-4704-b9d4-6c3dd7fe9267",
              "label": null,
              "isExecuted": false,
              "uuid": "83b1ff9b-9cc8-4913-8316-ef8af0340de1"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Configuration -> Get Reputation from AlienVault OTX",
              "targetStep": "/api/3/workflow_steps/04d90782-8806-4825-a0bd-c7377273cbab",
              "sourceStep": "/api/3/workflow_steps/03b1dad3-ff27-45c2-9d89-55dece9adb7b",
              "label": null,
              "isExecuted": false,
              "uuid": "51b3fbc2-d0b8-4b4b-a2b0-bcf8407b7913"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Configuration -> Get File Reputation from Symantec Deepsight Intelligence",
              "targetStep": "/api/3/workflow_steps/830d4f05-d741-4704-b9d4-6c3dd7fe9267",
              "sourceStep": "/api/3/workflow_steps/03b1dad3-ff27-45c2-9d89-55dece9adb7b",
              "label": null,
              "isExecuted": false,
              "uuid": "70156253-4e47-42e7-ae35-9a23b3f1421e"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get Reputation from AlienVault OTX -> Copy  of Compute Anomali Summary",
              "targetStep": "/api/3/workflow_steps/69488674-3e49-49dd-95b8-32a3bd8e9a20",
              "sourceStep": "/api/3/workflow_steps/04d90782-8806-4825-a0bd-c7377273cbab",
              "label": null,
              "isExecuted": false,
              "uuid": "a044e26d-b3cc-4229-80a0-7d04a8709279"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get File Reputation from Anomali -> Compute Anomali Summary",
              "targetStep": "/api/3/workflow_steps/b796e9df-d096-4f97-97cb-eca40a7543b6",
              "sourceStep": "/api/3/workflow_steps/f42c0116-0da6-4a59-aefa-2f78030977a3",
              "label": null,
              "isExecuted": false,
              "uuid": "4450885f-a170-4c77-b0ad-c2b050e36c6f"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Enrichment Summary -> Upon Create",
              "targetStep": "/api/3/workflow_steps/1d15fc8a-5ee1-4abd-affc-be2fedfaf9e5",
              "sourceStep": "/api/3/workflow_steps/516c492c-09b0-4b4e-84b2-ce403e9c2211",
              "label": null,
              "isExecuted": false,
              "uuid": "0512c9dc-c948-44d6-b13a-d0727229601d"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Upon Create -> Summary",
              "targetStep": "/api/3/workflow_steps/71ed97ab-6f2e-4f25-a648-c09d3f181698",
              "sourceStep": "/api/3/workflow_steps/1d15fc8a-5ee1-4abd-affc-be2fedfaf9e5",
              "label": "Referenced",
              "isExecuted": false,
              "uuid": "251a437d-4b81-47c6-adf6-bead0cc93aed"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Upon Create -> Update Record",
              "targetStep": "/api/3/workflow_steps/48414e38-d18e-4bfb-a9a4-389622481e7c",
              "sourceStep": "/api/3/workflow_steps/1d15fc8a-5ee1-4abd-affc-be2fedfaf9e5",
              "label": "Upon Create",
              "isExecuted": false,
              "uuid": "57ebb6ec-4eea-4626-9142-37e309752441"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Configuration -> Get File Reputation from VT",
              "targetStep": "/api/3/workflow_steps/bd567c84-e78c-4154-ac43-9906d66a1539",
              "sourceStep": "/api/3/workflow_steps/03b1dad3-ff27-45c2-9d89-55dece9adb7b",
              "label": null,
              "isExecuted": false,
              "uuid": "f4614558-dfda-4369-a73c-d762991c8b76"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get File Reputation from VT -> Compute VT Summary",
              "targetStep": "/api/3/workflow_steps/dcd08fa4-38c5-47dd-b8e8-e82562bdd449",
              "sourceStep": "/api/3/workflow_steps/bd567c84-e78c-4154-ac43-9906d66a1539",
              "label": null,
              "isExecuted": false,
              "uuid": "8f2a9ee0-a074-46c6-bc92-4c18aee29c89"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Is Malicious -> Set Malicious",
              "targetStep": "/api/3/workflow_steps/2fd0a162-3a5c-4618-b08e-be0275c1a4a1",
              "sourceStep": "/api/3/workflow_steps/458a2b1d-7dd1-499a-85c6-d1842508ca0c",
              "label": "Malicious",
              "isExecuted": false,
              "uuid": "3196dd88-6c44-4937-ad91-2a292b76ce0b"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Is Malicious -> Set Suspicious",
              "targetStep": "/api/3/workflow_steps/fd4e6cf7-296b-4d6f-a1e7-8028f144013f",
              "sourceStep": "/api/3/workflow_steps/458a2b1d-7dd1-499a-85c6-d1842508ca0c",
              "label": "Suspicious",
              "isExecuted": false,
              "uuid": "fcd527dc-3b78-49c9-999e-eb580c586297"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Compute Anomali Summary -> Is Malicious",
              "targetStep": "/api/3/workflow_steps/458a2b1d-7dd1-499a-85c6-d1842508ca0c",
              "sourceStep": "/api/3/workflow_steps/b796e9df-d096-4f97-97cb-eca40a7543b6",
              "label": null,
              "isExecuted": false,
              "uuid": "25f873dd-d710-4621-957e-dcf726c50845"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Compute AV OTX Summary -> Is Malicious",
              "targetStep": "/api/3/workflow_steps/458a2b1d-7dd1-499a-85c6-d1842508ca0c",
              "sourceStep": "/api/3/workflow_steps/69488674-3e49-49dd-95b8-32a3bd8e9a20",
              "label": null,
              "isExecuted": false,
              "uuid": "7e80438d-40a4-4ee8-819f-c484a9f11cb9"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Compute Symantec Summary -> Is Malicious",
              "targetStep": "/api/3/workflow_steps/458a2b1d-7dd1-499a-85c6-d1842508ca0c",
              "sourceStep": "/api/3/workflow_steps/ae3d2272-580d-47a5-806f-f077c8576936",
              "label": null,
              "isExecuted": false,
              "uuid": "2231bcac-39ad-4789-856a-e2660a650c6a"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Malicious -> Enrichment Summary",
              "targetStep": "/api/3/workflow_steps/516c492c-09b0-4b4e-84b2-ce403e9c2211",
              "sourceStep": "/api/3/workflow_steps/2fd0a162-3a5c-4618-b08e-be0275c1a4a1",
              "label": null,
              "isExecuted": false,
              "uuid": "450c5f2e-3de1-4bdb-a437-2107cfad7734"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Good -> Enrichment Summary",
              "targetStep": "/api/3/workflow_steps/516c492c-09b0-4b4e-84b2-ce403e9c2211",
              "sourceStep": "/api/3/workflow_steps/b7a048ad-0c0a-45ab-a980-4012bcdb2c67",
              "label": null,
              "isExecuted": false,
              "uuid": "b52740e8-5580-4cf7-b1ea-fc47bee61cef"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set No Reputation -> Enrichment Summary",
              "targetStep": "/api/3/workflow_steps/516c492c-09b0-4b4e-84b2-ce403e9c2211",
              "sourceStep": "/api/3/workflow_steps/daf2da7a-468d-4ee6-9adc-36f12e763500",
              "label": null,
              "isExecuted": false,
              "uuid": "3dc35036-4454-44fb-aa54-05d8d727f2cf"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Suspicious -> Enrichment Summary",
              "targetStep": "/api/3/workflow_steps/516c492c-09b0-4b4e-84b2-ce403e9c2211",
              "sourceStep": "/api/3/workflow_steps/fd4e6cf7-296b-4d6f-a1e7-8028f144013f",
              "label": null,
              "isExecuted": false,
              "uuid": "c52196f4-5754-4010-9fb6-03b479d40698"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Compute VT Summary -> Compute Basic Properties",
              "targetStep": "/api/3/workflow_steps/85ef1e60-c531-4123-bba2-de1e9d7bf132",
              "sourceStep": "/api/3/workflow_steps/dcd08fa4-38c5-47dd-b8e8-e82562bdd449",
              "label": null,
              "isExecuted": false,
              "uuid": "c8445d48-5327-427a-a372-bd43bfe64a66"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Compute Additional Summary -> Is Malicious",
              "targetStep": "/api/3/workflow_steps/458a2b1d-7dd1-499a-85c6-d1842508ca0c",
              "sourceStep": "/api/3/workflow_steps/2bc757fb-309e-4bd1-9f68-542509b94e70",
              "label": null,
              "isExecuted": false,
              "uuid": "7fd2351a-e8f5-4d88-9ccb-995c54e7c37e"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Compute Basic Properties -> Compute VT Signature Info",
              "targetStep": "/api/3/workflow_steps/685c2461-f587-4aea-864b-5f688bdfdf47",
              "sourceStep": "/api/3/workflow_steps/85ef1e60-c531-4123-bba2-de1e9d7bf132",
              "label": null,
              "isExecuted": false,
              "uuid": "88292de6-0ea4-489f-9b89-6e94d725f2e7"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Compute Sandbox Verdict from VT -> Compute Additional Summary",
              "targetStep": "/api/3/workflow_steps/2bc757fb-309e-4bd1-9f68-542509b94e70",
              "sourceStep": "/api/3/workflow_steps/03182d2e-c087-4a89-a867-1e132e9f7e0d",
              "label": null,
              "isExecuted": false,
              "uuid": "3d99f0ec-4efc-402c-a3df-6b1127c2e22e"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Compute VT Signature Info -> sandbox_detection",
              "targetStep": "/api/3/workflow_steps/62a0342f-5907-4f8e-9cda-168ffc3a1e7f",
              "sourceStep": "/api/3/workflow_steps/685c2461-f587-4aea-864b-5f688bdfdf47",
              "label": null,
              "isExecuted": false,
              "uuid": "12ad2bb6-af19-4b4f-9937-0c54ecbe796d"
            },
            {
              "@type": "WorkflowRoute",
              "name": "sandbox_detection -> Compute Sandbox Verdict from VT",
              "targetStep": "/api/3/workflow_steps/03182d2e-c087-4a89-a867-1e132e9f7e0d",
              "sourceStep": "/api/3/workflow_steps/62a0342f-5907-4f8e-9cda-168ffc3a1e7f",
              "label": null,
              "isExecuted": false,
              "uuid": "eb4550cf-0226-41a3-a602-975fecab8ad4"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Has Dedicated Tenant Record -> Exit",
              "targetStep": "/api/3/workflow_steps/cb74cfa6-3bd1-4726-8d8e-ebc77ce81edf",
              "sourceStep": "/api/3/workflow_steps/9cbb853e-78ba-467d-b91d-6ade7dbf491d",
              "label": "Yes, Enrich at Tenant Node",
              "isExecuted": false,
              "uuid": "74cb4a9f-f4e7-49b1-8da0-d268f06d8221"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Has Dedicated Tenant Record",
              "targetStep": "/api/3/workflow_steps/9cbb853e-78ba-467d-b91d-6ade7dbf491d",
              "sourceStep": "/api/3/workflow_steps/f02f1e12-1802-4262-bdc4-ba2e4ccd35ea",
              "label": null,
              "isExecuted": false,
              "uuid": "7b4e6677-3158-424f-8b35-f6fe2a1afda4"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Has Dedicated Tenant Record -> Configuration",
              "targetStep": "/api/3/workflow_steps/03b1dad3-ff27-45c2-9d89-55dece9adb7b",
              "sourceStep": "/api/3/workflow_steps/9cbb853e-78ba-467d-b91d-6ade7dbf491d",
              "label": "No, Enrich Here",
              "isExecuted": false,
              "uuid": "9e93a495-31b2-4729-a396-0fee31a58d5e"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Is Malicious -> Set Good",
              "targetStep": "/api/3/workflow_steps/b7a048ad-0c0a-45ab-a980-4012bcdb2c67",
              "sourceStep": "/api/3/workflow_steps/458a2b1d-7dd1-499a-85c6-d1842508ca0c",
              "label": "Safe",
              "isExecuted": false,
              "uuid": "1d24c6bf-0171-4761-8796-8a9d978a14b0"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Is Malicious -> Set No Reputation",
              "targetStep": "/api/3/workflow_steps/daf2da7a-468d-4ee6-9adc-36f12e763500",
              "sourceStep": "/api/3/workflow_steps/458a2b1d-7dd1-499a-85c6-d1842508ca0c",
              "label": "No Reputation",
              "isExecuted": false,
              "uuid": "18db3fa1-a0ef-41c1-86e9-2aa36ca516d4"
            }
          ],
          "priority": null,
          "uuid": "a211813c-fddc-4578-8e13-48e3efcc2ae3",
          "id": 84,
          "createUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "createDate": 1649319945.017795,
          "modifyUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "modifyDate": 1649319945.017795,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [
            {
              "apiName": "sOARFramework",
              "name": "SOAR Framework",
              "version": "1.0.0"
            }
          ],
          "recordTags": [
            "Subroutine"
          ]
        }
      ]
    }
  ],
  "exported_tags": [
    "Subroutine"
  ]
}
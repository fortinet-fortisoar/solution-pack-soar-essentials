{
  "type": "workflow_collections",
  "data": [
    {
      "@context": "/api/3/contexts/WorkflowCollection",
      "@type": "WorkflowCollection",
      "name": "03 - Enrich",
      "description": null,
      "visible": true,
      "image": null,
      "uuid": "bea2a6c5-c98d-4ee5-befd-9fbfd11c2a32",
      "id": 18,
      "createDate": 1649319945.015677,
      "modifyDate": 1649319945.015677,
      "deletedAt": null,
      "importedBy": [
        {
          "apiName": "sOARFramework",
          "name": "SOAR Framework",
          "version": "1.0.0"
        }
      ],
      "recordTags": [],
      "workflows": [
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Indicator (Type IP) - Get Reputation",
          "aliasName": null,
          "tag": "#Subroutine",
          "description": "Get Reputation of IP address",
          "isActive": true,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [
            "indicator_value"
          ],
          "synchronous": false,
          "lastModifyDate": 1649319945,
          "collection": "/api/3/workflow_collections/bea2a6c5-c98d-4ee5-befd-9fbfd11c2a32",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/69d68800-c7c3-484e-b0e8-0d36747377c2",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Get Reputation from AlienVault OTX",
              "description": null,
              "arguments": {
                "name": "AlienVault-OTX",
                "config": "3d96900a-f870-4ac6-94d0-00865dbaf86f",
                "params": {
                  "page": 1,
                  "limit": 5,
                  "user_text": "{{vars.record}}"
                },
                "version": "1.0.0",
                "connector": "alienvault-otx",
                "operation": "search_pulses",
                "ignore_errors": true,
                "operationTitle": "Search Pulses",
                "step_variables": {
                  "foundAVReputation": "{{ ( vars.result.data.results and vars.result.data.results|json_query(\"[*].tags[]\") | length > 0 ) | ternary(true,false) }}"
                }
              },
              "status": null,
              "top": "30",
              "left": "2075",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "c48fd9d8-2e58-4a7c-a9f5-4651e3cd2cac"
            },
            {
              "@type": "WorkflowStep",
              "name": "Is Referenced",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "option": "Referenced",
                    "step_iri": "/api/3/workflow_steps/416479fc-52c9-467d-866e-7182441b855d",
                    "condition": "{{ vars.input.params['indicator_value'] | length > 0 }}"
                  },
                  {
                    "option": "Upon Create",
                    "default": true,
                    "step_iri": "/api/3/workflow_steps/2380682f-1f1b-4fe6-9aa9-da0429094277"
                  }
                ]
              },
              "status": null,
              "top": "510",
              "left": "3700",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "uuid": "b25e951b-5d3d-4658-abb1-01f50b135b28"
            },
            {
              "@type": "WorkflowStep",
              "name": "Summary",
              "description": null,
              "arguments": {
                "country": "{%if vars.steps.Geo_Locate_IP.data[0].location['country_flag']%}\n<center><span style=\"float: center;\"><img src=\"{{vars.steps.Geo_Locate_IP.data[0].location['country_flag']}}\" width=\"25\" ></span></center>\n{%endif%}",
                "reputation": "{{vars.Reputation_Type_Text}}",
                "reputation_iri": "{{vars.Reputation_Type_IRI}}",
                "enrichment_summary": "{{vars.steps.Enrichment_Summary.data['formatted_string']}}"
              },
              "status": null,
              "top": "430",
              "left": "4025",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "416479fc-52c9-467d-866e-7182441b855d"
            },
            {
              "@type": "WorkflowStep",
              "name": "Set Malicious",
              "description": null,
              "arguments": {
                "Reputation_Type_IRI": "{{(\"IndicatorReputation\" | picklist(\"Malicious\"))[\"@id\"]}}",
                "Reputation_Type_Text": "Malicious"
              },
              "status": null,
              "top": "190",
              "left": "3050",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "5ed210f0-e575-4e5f-b4d0-e1d50100cd8b"
            },
            {
              "@type": "WorkflowStep",
              "name": "Set Good",
              "description": null,
              "arguments": {
                "Reputation_Type_IRI": "{{(\"IndicatorReputation\" | picklist(\"Good\"))[\"@id\"]}}",
                "Reputation_Type_Text": "Good"
              },
              "status": null,
              "top": "350",
              "left": "3050",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "88ef889a-3249-4988-8516-8970fd64a586"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Reputation from MxToolbox",
              "description": null,
              "arguments": {
                "name": "MxToolbox",
                "config": "aa41f424-4472-4f04-aeec-0a17d6df45f8",
                "params": {
                  "value": "{{vars.record}}",
                  "object": "blacklist",
                  "api_method": "Lookup"
                },
                "version": "1.0.0",
                "connector": "mxtoolbox",
                "operation": "api_call",
                "ignore_errors": true,
                "operationTitle": "Get MxToolbox Records",
                "step_variables": {
                  "foundIPMxReputation": "{{ ( vars.result.data and (vars.result.data | length > 0) ) | ternary(true,false) }}"
                }
              },
              "status": null,
              "top": "670",
              "left": "2075",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "2698e5e5-89b8-4d27-977c-d7893b3aefb3"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get IP Reputation from Anomali",
              "description": null,
              "arguments": {
                "name": "Anomali ThreatStream",
                "config": "d5bbd0d1-2955-4705-a9a6-e7c1289e09d0",
                "params": {
                  "limit": 20,
                  "value": "{{vars.record}}",
                  "offset": 0,
                  "validation": false,
                  "filter_option": "Exact",
                  "record_number": "Fetch Limited Records"
                },
                "version": "2.2.1",
                "connector": "threatstream",
                "operation": "ip_reputation",
                "ignore_errors": true,
                "operationTitle": "Get IP Reputation",
                "pickFromTenant": false,
                "step_variables": {
                  "foundAnomaliReputation": "{{ ( vars.result.data.objects and vars.result.data.objects | length > 0 ) | ternary(true,false) }}"
                }
              },
              "status": null,
              "top": "190",
              "left": "2075",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "f30bb09c-ba1d-48ed-83dd-fc937f947e41"
            },
            {
              "@type": "WorkflowStep",
              "name": "Geo Locate IP",
              "description": null,
              "arguments": {
                "name": "IPStack",
                "config": "0022176c-57c0-4120-a8d2-ac03990bc318",
                "params": {
                  "query": "{{vars.record}}",
                  "fields": "",
                  "enable_hostname": false,
                  "enable_security": false
                },
                "version": "1.0.0",
                "connector": "ipstack",
                "operation": "ip_locate",
                "ignore_errors": true,
                "operationTitle": "Geolocate IP",
                "step_variables": {
                  "foundIpStackReputation": "{{ ( vars.result.data and (vars.result.data | length > 0) ) | ternary(true,false) }}"
                }
              },
              "status": null,
              "top": "350",
              "left": "2075",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "e350bca0-99b1-472d-8282-b4cc05033863"
            },
            {
              "@type": "WorkflowStep",
              "name": "Configuration",
              "description": null,
              "arguments": {
                "record": "{{vars.input.params['indicator_value'] | ternary(vars.input.params['indicator_value'],vars.input.records[0].value) }}",
                "whoisdata_dict": "{}",
                "googleMapAPIkey": "AIzaSyDy4tlleelMlMRB-HuBbgxeBMrfUJQF2ZE",
                "foundIPMxReputation": "false",
                "foundAnomaliReputation": "false",
                "foundIpStackReputation": "false",
                "VT_reputation_threshold": "5"
              },
              "status": null,
              "top": "430",
              "left": "1100",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "8fe56d68-2662-4618-bd2f-63afb66ab0ec"
            },
            {
              "@type": "WorkflowStep",
              "name": "Compute AV OTX Summary",
              "description": null,
              "arguments": {
                "params": {
                  "value": "<p>{% if vars.foundAVReputation %}</p>\n<div class=\"font-size-11 ng-binding padding-bottom-sm\"><h4 style=\"background: #404142;padding: 5px;text-align: left;color: orange;background: black;\"> AlienVault OTX Summary</h4></div> \n<table style=\"width: 506px; border-color: #ffffff;\" border=\"1\">\n<tbody>\n<tr>\n<td style=\"width: 45px;font-size:16px;font-weight: normal\"><strong>Tags</strong></td>\n<td> <div class=\"font-size-14 font-weight-normal\">{{(vars.steps.Get_Reputation_from_AlienVault_OTX.data.results | json_query(\"[*].tags[]\") | unique | string).replace(\"[\",\"\").replace(\"]\",\"\")}}</div></td>\n</tr>\n</tbody>\n</table>\n<p>{% endif %}</p>\n"
                },
                "version": "3.1.1",
                "connector": "cyops_utilities",
                "operation": "format_richtext",
                "operationTitle": "Utils: Format as RichText",
                "step_variables": []
              },
              "status": null,
              "top": "30",
              "left": "2400",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "d673bca8-dd0d-45aa-aaba-1737046bb51f"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Reputation from VT",
              "description": null,
              "arguments": {
                "name": "VirusTotal",
                "config": "8afd8a09-4f71-4cba-bb4e-31cd72da1a4e",
                "params": {
                  "ip": "{{vars.record}}",
                  "relationships": ""
                },
                "version": "2.2.0",
                "connector": "virustotal",
                "operation": "query_ip",
                "operationTitle": "Get IP Reputation",
                "pickFromTenant": false,
                "step_variables": {
                  "temp": "{% if vars.result.data.attributes.whois.raw %}{%- for item in vars.result.data.attributes.whois.raw[0].split(\"\\n\") -%}{%- set key = item.split(\":\")[0] -%}{%- set value = item.split(\":\")[1:] | join(\"\") -%}{%if value and key%}{{vars.whoisdata_dict.update({key:value})}}{%endif%}{%- endfor -%}{%endif%}",
                  "community_votes": "{{vars.result.data.attributes['total_votes']}}",
                  "last_analysis_stats": "{{vars.result.data.attributes['last_analysis_stats']}}"
                }
              },
              "status": null,
              "top": "840",
              "left": "1420",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "5ff14e87-d6af-4173-a3ba-57e63d5d800b"
            },
            {
              "@type": "WorkflowStep",
              "name": "Whois IP",
              "description": null,
              "arguments": {
                "name": "Whois RDAP",
                "config": "5f97d024-1ef2-4b73-b639-a2ec235f490d",
                "params": {
                  "ip": "{{vars.record}}"
                },
                "version": "1.0.0",
                "connector": "whois-rdap",
                "operation": "whois_ip",
                "ignore_errors": true,
                "operationTitle": "Whois IP",
                "step_variables": {
                  "foundWhoIsReputation": "{{ ( vars.result.data.asn_country_code and vars.result.data.asn_country_code | length > 0 ) | ternary(true,false) }}"
                }
              },
              "status": null,
              "top": "510",
              "left": "2075",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "b07a73b5-9188-4ef7-910b-89eba6b06a4f"
            },
            {
              "@type": "WorkflowStep",
              "name": "Compute Private IP Summary",
              "description": null,
              "arguments": {
                "when": "{{vars.hostname != \"\"}}",
                "params": {
                  "value": "{% if vars.hostname %}\n<div class=\"card-container-body\" style=\"width: 280px;\">\n<div class=\"card-number\"><span class=\"card-count\">0</span>\n<div class=\"font-size-12 ng-binding\">Hostname: {{vars.hostname}}</div>\n{%else%}\n<div class=\"card-container-body\" style=\"width: 280px;\">\n<div class=\"card-number\"><span class=\"card-count\">0</span>\n<div class=\"font-size-12 ng-binding\">Hostname: Not Available <i class=\"icon icon-information margin-left-sm\" title=\"nslookup could not find hostname\"></i>\n</div>\n\n {%endif%}\n<div class=\"font-size-14 ng-binding\"><strong>Internal IP</strong></div>\n</div>\n</div>"
                },
                "version": "3.0.4",
                "connector": "cyops_utilities",
                "operation": "format_richtext",
                "operationTitle": "Utils: Format as RichText",
                "step_variables": []
              },
              "status": null,
              "top": "990",
              "left": "2725",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "68bfbb10-dbf4-4532-909c-d70a1defceb7"
            },
            {
              "@type": "WorkflowStep",
              "name": "Compute Anomali Summary",
              "description": null,
              "arguments": {
                "params": {
                  "value": "<p>{% if vars.foundAnomaliReputation %}</p>\n<div class=\"font-size-11 ng-binding padding-bottom-sm\"><h4 style=\"background: #404142;padding: 5px;text-align: left;color: orange;background: black;\"> Anomali Threatstream Detection Summary</h4></div>\n<div class=\"card-container-body\" style=\"width: 170px;\">\n{%if vars.steps.Get_IP_Reputation_from_Anomali.data.objects[0].threatscore !=0 %}\n<div class=\"card-number padding-top-sm padding-bottom-sm\" style=\" border-left: 5px solid red;background:#141b23\">\n <div class=\"line-height-1\"><a href=\"https://ui.threatstream.com/detail/domain/{{vars.indicator_value}}\" target=\"_blank\" rel=\"noopener noreferrer\" class=\"font-size-8em\"> <span class=\"card-count\">{{vars.steps.Get_IP_Reputation_from_Anomali.data.objects[0].threatscore}} </span> </a>\n<div class=\"font-size-14 font-weight-normall padding-top-sm padding-bottom-sm\">Severity: {{vars.steps.Get_IP_Reputation_from_Anomali.data.objects[0].meta.severity}}</div>\n{%else%}\n<div class=\"card-number padding-top-sm padding-bottom-sm\" style=\" border-left: 5px solid red\">\n <div class=\"line-height-1\"><a href=\"https://ui.threatstream.com/detail/domain/{{vars.indicator_value}}\" target=\"_blank\" rel=\"noopener noreferrer\" class=\"font-size-8em\"> <span class=\"card-count\">{{vars.steps.Get_IP_Reputation_from_Anomali.data.objects[0].threatscore}} </span> </a>\n<div class=\"font-size-14 font-weight-normall padding-top-sm padding-bottom-sm\">Severity: {{vars.steps.Get_IP_Reputation_from_Anomali.data.objects[0].meta.severity}}{% endif %}\n</div>\n\n</div>\n</div>\n<p>{% endif %}</p>\n"
                },
                "version": "3.1.1",
                "connector": "cyops_utilities",
                "operation": "format_richtext",
                "operationTitle": "Utils: Format as RichText",
                "step_variables": []
              },
              "status": null,
              "top": "190",
              "left": "2400",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "a09686ed-d7ce-4531-87be-44f8af4f7b1e"
            },
            {
              "@type": "WorkflowStep",
              "name": "Whois Information from VT",
              "description": null,
              "arguments": {
                "when": "{{(vars.whoisdata_dict | length > 0)}}",
                "params": {
                  "data": "{{vars.whoisdata_dict}}",
                  "styling": true,
                  "row_fields": "",
                  "table_style": "{ 'width':'auto','font':'10px;'}"
                },
                "version": "3.1.2",
                "connector": "cyops_utilities",
                "operation": "json_to_html",
                "operationTitle": "Utils: Convert JSON into a HTML Table",
                "step_variables": []
              },
              "status": null,
              "top": "840",
              "left": "1740",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "5a61408d-b79e-4a37-a6ea-a6e9c91f573a"
            },
            {
              "@type": "WorkflowStep",
              "name": "Compute VT Summary",
              "description": null,
              "arguments": {
                "params": {
                  "value": "<div class=\"font-size-11 ng-binding padding-bottom-sm\"><h4 style=\"background: #404142;padding: 5px;text-align: left;color: orange;background: black;\"> VirusTotal Detection Summary</h4></div>\n<table style=\"border-color: #04080c;\" border=\"1\" class=\"font-normal\">\n<tr><td>\n<table style=\"color:white;font-size:11;\" >\n<tr>\n<td>\n<html>\n  <head>\n    <title>Title of the document</title>\n    <style>\n      span.circle {\n        background: #2f3f51;\n        border-radius: 50%;\n        -moz-border-radius: 50%;\n        -webkit-border-radius: 50%;\n        display: inline-block;\n         font-weight: bold;\n        line-height: 100px;\n        margin-right: 5px;\n        text-align: center;\n        width: 100px;\n      font-size:15px;\n     border-color: Black;\n      }\n    </style>\n  </head>\n  <body><span class=\"circle\"><i style=\"font-size:25px;color:red \">\n   {{vars.last_analysis_stats.malicious}}</i>/{{vars.last_analysis_stats.values() | list | sum}}</span>\n  </body>\n</html>\n</td>\n\n<td>\n<div class=\"font-size-14 ng-binding\">Malicious</div>\n<div class=\"card-container-body\" style=\"width: 100px;font-size:46px;\">\n<div class=\"card-number\"; style=\"font-size:45px;  border-left: 5px solid red;background:#141b23\">{{vars.last_analysis_stats.malicious}}</div>\n</div>\n</td>\n<td>\n<div class=\"font-size-14 ng-binding\">Suspicious</div>\n<div class=\"card-container-body\" style=\"width: 100px;\">\n<div class=\"card-number\" style=\"font-size:45px;  border-left: 5px solid orange; background:#141b23\">{{vars.last_analysis_stats.suspicious}}</div>\n</div>\n</td>\n<td>\n<div class=\"font-size-14 ng-binding\">Harmless</div>\n<div class=\"card-container-body\" style=\"width: 100px;\">\n<div class=\"card-number\" style=\"font-size:45px;  border-left: 5px solid green; background:#141b23\">{{vars.last_analysis_stats.harmless}}</div></div>\n</td>\n</tr>\n</table>\n\n<td style=\"vertical-align:top\">\n<table style=\"background-color: #1b2430; color:white;font-size:16;\" class=\"margin-10\">\n<tr>\n<div class=\"margin-top-md\">\n<i class=\"fa fa-group margin-left-md margin-right-sm\"></i> Community Votes</div>\n\n<td style=\"width: 100px;text-align: center;background:#141b23\">\n<i class=\"\tfa fa-thumbs-o-up\" style=\"font-size:25px;color:green\"></i>\n<div class=\"font-size-11 ng-binding\">Harmless {{vars.community_votes.harmless}}</div>\n</td>\n<td style=\"width: 100px;text-align: center;background:#141b23\">\n<i class=\"fa fa-thumbs-o-down\" style=\"font-size:25px;color:red \"></i>\n<div class=\"font-size-11 ng-binding\">Malicious {{vars.community_votes.malicious}}</div>\n</td>\n</tr>\n</table>\n</div>\n</td>\n</tr>\n</table>"
                },
                "version": "3.1.1",
                "connector": "cyops_utilities",
                "operation": "format_richtext",
                "operationTitle": "Utils: Format as RichText",
                "step_variables": {
                  "WhoisInformationVT": "{{vars.steps.Get_Reputation_from_VT.data.whois}}"
                }
              },
              "status": null,
              "top": "840",
              "left": "2080",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "3ec77e79-987e-482b-973c-f139010c0712"
            },
            {
              "@type": "WorkflowStep",
              "name": "Set No Reputation for Private IP",
              "description": null,
              "arguments": {
                "Reputation_Type_IRI": "{{(\"IndicatorReputation\" | picklist(\"No Reputation Available\"))[\"@id\"]}}",
                "Reputation_Type_Text": "No Reputation Available"
              },
              "status": null,
              "top": "990",
              "left": "3050",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "8c656fed-cd7d-4f19-8f29-185313216bc3"
            },
            {
              "@type": "WorkflowStep",
              "name": "Set Suspicious",
              "description": null,
              "arguments": {
                "Reputation_Type_IRI": "{{(\"IndicatorReputation\" | picklist(\"Suspicious\"))[\"@id\"]}}",
                "Reputation_Type_Text": "Suspicious"
              },
              "status": null,
              "top": "830",
              "left": "3050",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "9b2a4cde-9a70-4c50-9040-36e6a650efe5"
            },
            {
              "@type": "WorkflowStep",
              "name": "Is IP Private",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "option": "Public IP",
                    "default": true,
                    "step_iri": "/api/3/workflow_steps/8fe56d68-2662-4618-bd2f-63afb66ab0ec",
                    "step_name": "Configuration"
                  },
                  {
                    "option": "Private IP",
                    "step_iri": "/api/3/workflow_steps/0df74b33-8447-4e08-87d8-b2389e88e87f",
                    "condition": "{{ vars.steps.Match_IP_in_Internal_Subnets.data['matched_cidr_ip'] | length > 0 }}",
                    "step_name": "Find Hostname for Internal IP"
                  }
                ]
              },
              "status": null,
              "top": "740",
              "left": "780",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "uuid": "2ff5f09b-f174-4206-95dd-9837f8d782cd"
            },
            {
              "@type": "WorkflowStep",
              "name": "Compute MxToolbox Summary",
              "description": null,
              "arguments": {
                "params": {
                  "value": "<p>{% if vars.foundIPMxReputation %}</p>\n<div class=\"font-size-11 ng-binding padding-bottom-sm\"><h4 style=\"background: #404142;padding: 5px;text-align: left;color: orange;background: black;\"> MXToolbox Summary</h4></div>\n<div class=\"card-container-body\" style=\"width: 200px;\">\n<div class=\"card-number \" style=\"font-size: 50px; font-weight: normal\"; class=\"font-size-8em\"><span class=\"card-count\">{{vars.steps.Get_Reputation_from_MxToolbox.data.result.MxRep}}</span>\n<div class=\"font-size-14 font-weight-normall padding-top-sm padding-bottom-sm\">{% if vars.steps.Get_Reputation_from_MxToolbox.data.result.MxRep == 100 %}Not blacklisted{%else%}Blacklisted{%endif%}</div>\n\n</div>\n</div>\n<p>{% endif %}&nbsp;</p>"
                },
                "version": "3.1.1",
                "connector": "cyops_utilities",
                "operation": "format_richtext",
                "ignore_errors": true,
                "operationTitle": "Utils: Format as RichText",
                "step_variables": []
              },
              "status": null,
              "top": "670",
              "left": "2400",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "337de963-c807-4e4a-a5c4-cd5b74c9a8ab"
            },
            {
              "@type": "WorkflowStep",
              "name": "Match IP in Internal Subnets",
              "description": null,
              "arguments": {
                "params": {
                  "cidr": "['10.0.0.0/8','172.16.0.0/12','192.168.0.0/16']",
                  "ip_address": "{{vars.input.params['indicator_value'] | ternary(vars.input.params['indicator_value'],vars.input.records[0].value) }}"
                },
                "version": "2.7.0",
                "connector": "cyops_utilities",
                "operation": "ip_cidr_check",
                "operationTitle": "Utils: Is IP in CIDR",
                "step_variables": []
              },
              "status": null,
              "top": "740",
              "left": "480",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "c1265c91-f6dd-42c1-aef8-3267fe4da659"
            },
            {
              "@type": "WorkflowStep",
              "name": "Update Record",
              "description": null,
              "arguments": {
                "resource": {
                  "__link": {
                    "recordTags": "{% if vars.foundAVReputation %}{{(vars.steps.Get_Reputation_from_AlienVault_OTX.data.results | json_query(\"[*].tags[]\") | unique | string).replace(\"[\",\"\").replace(\"]\",\"\").replace(\"?\",\"\").replace(\"\\'\",\"\").replace(\"#\",\"\").replace(\"\\\"\",\"\").replace(\"/\",\"\").replace(\"*\",\"\")}}{%endif%}"
                  },
                  "country": "{%if vars.steps.Geo_Locate_IP.data[0].location['country_flag']%}\n<center><span style=\"float: center\"; title=\"{{vars.steps.Geo_Locate_IP.data[0]['country_name']}}\";><img src=\"{{vars.steps.Geo_Locate_IP.data[0].location['country_flag']}}\" width=\"25\" ></span></center>\n{%endif%}\n",
                  "reputation": "{{vars.Reputation_Type_IRI}}",
                  "description": "{{vars.steps.Enrichment_Summary.data['formatted_string']}}\n"
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "{{vars.input.records[0]['@id']}}",
                "__recommend": [],
                "collectionType": "/api/3/indicators",
                "fieldOperation": {
                  "recordTags": "Append"
                },
                "step_variables": []
              },
              "status": null,
              "top": "590",
              "left": "4025",
              "stepType": "/api/3/workflow_step_types/b593663d-7d13-40ce-a3a3-96dece928722",
              "uuid": "2380682f-1f1b-4fe6-9aa9-da0429094277"
            },
            {
              "@type": "WorkflowStep",
              "name": "Set No Reputation",
              "description": null,
              "arguments": {
                "Reputation_Type_IRI": "{{(\"IndicatorReputation\" | picklist(\"No Reputation Available\"))[\"@id\"]}}",
                "Reputation_Type_Text": "No Reputation Available"
              },
              "status": null,
              "top": "670",
              "left": "3050",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "uuid": "dedcd11c-3bda-4576-a69b-f8990a9ba767"
            },
            {
              "@type": "WorkflowStep",
              "name": "Compute IP Stack Summary",
              "description": null,
              "arguments": {
                "params": {
                  "value": "<p>{% if vars.foundIpStackReputation %}</p>\n<div class=\"font-size-11 ng-binding padding-bottom-sm\">\n<h4 style=\"background: #404142;padding: 5px;text-align: left;color: orange;background: black;\"> IP Stack </h4></div>\n<table>\n<tbody>\n<tr>\n<td style=\"vertical-align: top;\">\n<p><span style=\"font-size: 10pt;\"><strong>{% if vars.foundIpStackReputation%}</strong></span></p>\n<div class=\"font-size-17 margin-top-12 padding-bottom-sm padding-left-sm\"><strong>Location Summary:</strong></div> \n<table style=\"width: 506px;\" border=\"1\" >\n<tbody>\n<tr style=\"height: 16px;\">\n<td style=\"border: 1px solid white; text-align: left; width: 135px; height: 16px;\"><span style=\"font-size: 10pt;\">Country</span></td>\n<td style=\"border: 1px solid white; text-align: left; width: 370px; height: 16px;\"><span style=\"font-size: 10pt;\">{{vars.steps.Geo_Locate_IP.data[0]['country_name']}}</span></td>\n</tr>\n<tr style=\"height: 16px;\">\n<td style=\"border: 1px solid white; text-align: left; width: 135px; height: 16px;\"><span style=\"font-size: 10pt;\">City</span></td>\n<td style=\"border: 1px solid white; text-align: left; width: 370px; height: 16px;\"><span style=\"font-size: 10pt;\">{{vars.steps.Geo_Locate_IP.data[0].city}}</span></td>\n</tr>\n<tr style=\"height: 16.9034px;\">\n<td style=\"border: 1px solid white; text-align: left; width: 135px; height: 16px;\"><span style=\"font-size: 10pt;;\">Latitude</span></td>\n<td style=\"border: 1px solid white; text-align: left; width: 370px; height: 16px;\"><span style=\"font-size: 10pt;\">{{vars.steps.Geo_Locate_IP.data[0].latitude}}</span></td>\n</tr>\n<tr style=\"height: 16.9034px;\">\n<td style=\"border: 1px solid white; text-align: left; width: 135px; height: 16px;\"><span style=\"font-size: 10pt;\">Longitude</span></td>\n<td style=\"border: 1px solid white; text-align: left; width: 370px; height: 16px;\"><span style=\"font-size: 10pt;\">{{vars.steps.Geo_Locate_IP.data[0].longitude}}</span></td>\n</tr>\n</tbody>\n</table>\n<td>\n\n<div class=\"font-size-17  padding-bottom-sm\"><strong>Map Location </strong></div>\n<img src=\"https://maps.googleapis.com/maps/api/staticmap?key={{vars.googleMapAPIkey}}&center={{vars.steps.Geo_Locate_IP.data[0].latitude}},{{vars.steps.Geo_Locate_IP.data[0].longitude}}&zoom=13&format=png&maptype=roadmap&style=element:geometry|color:0x242f3e&style=element:labels.text.fill|color:0x746855&style=element:labels.text.stroke|color:0x242f3e&style=feature:administrative.locality|element:labels.text.fill|color:0xd59563&style=feature:poi|element:labels.text.fill|color:0xd59563&style=feature:poi.park|element:geometry|color:0x263c3f&style=feature:poi.park|element:labels.text.fill|color:0x6b9a76&style=feature:road|element:geometry|color:0x38414e&style=feature:road|element:geometry.stroke|color:0x212a37&style=feature:road|element:labels.text.fill|color:0x9ca5b3&style=feature:road.highway|element:geometry|color:0x746855&style=feature:road.highway|element:geometry.stroke|color:0x1f2835&style=feature:road.highway|element:labels.text.fill|color:0xf3d19c&style=feature:transit|element:geometry|color:0x2f3948&style=feature:transit.station|element:labels.text.fill|color:0xd59563&style=feature:water|element:geometry|color:0x17263c&style=feature:water|element:labels.text.fill|color:0x515c6d&style=feature:water|element:labels.text.stroke|color:0x17263c&size=600x300&markers=size:mid|color:0xff0000|label:|{{vars.steps.Geo_Locate_IP.data[0].latitude}},{{vars.steps.Geo_Locate_IP.data[0].longitude}}\" alt=\"\" width=\"500px\" height=\"300\" />\n{% endif %}\n</td>\n</tr>\n</tbody>\n</table>\n{% endif %}\n"
                },
                "version": "3.1.2",
                "connector": "cyops_utilities",
                "operation": "format_richtext",
                "operationTitle": "Utils: Format as RichText",
                "step_variables": []
              },
              "status": null,
              "top": "340",
              "left": "2400",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "eb79f8bb-3699-4d47-8b34-de9957092f72"
            },
            {
              "@type": "WorkflowStep",
              "name": "Enrichment Summary",
              "description": null,
              "arguments": {
                "params": {
                  "value": "{% if vars.steps.Match_IP_in_Internal_Subnets.data['ip_matched'] %}<!--\n-->{{vars.steps.Compute_Private_IP_Summary.data['formatted_string']}}\n{% else %}\n{{vars.steps.Compute_VT_Summary.data['formatted_string']}}\n{% endif %}       \n\n{{vars.steps.Compute_Anomali_Summary.data['formatted_string']}}    \n\n{{vars.steps.Compute_IP_Stack_Summary.data['formatted_string']}}\n\n{{vars.steps.Compute_AV_OTX_Summary.data['formatted_string']}}\n      \n{{vars.steps.Compute_MxToolbox_Summary.data['formatted_string']}}\n \n{{vars.steps.Compute_VT_Whois.data['formatted_string']}}\n\n\n\n"
                },
                "version": "3.1.1",
                "connector": "cyops_utilities",
                "operation": "format_richtext",
                "operationTitle": "Utils: Format as RichText",
                "step_variables": []
              },
              "status": null,
              "top": "510",
              "left": "3375",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "2b952c7e-7e85-4eb3-9712-44c1268781e1"
            },
            {
              "@type": "WorkflowStep",
              "name": "Compute Whois Summary",
              "description": null,
              "arguments": {
                "params": {
                  "value": "{% if vars.foundWhoIsReputation %}<div class=\"font-size-11 ng-binding padding-bottom-sm\"><h4 style=\"background: #404142;padding: 5px;text-align: left;color: orange;background: black;\">Whois IP Summary</h4></div>\n<table style=\"width: 500px;\" border=\"\\&quot;1\\&quot;\">\n<tbody>\n<tr>\n<td style=\"width: 100px;\"><strong>asn_country_code</strong></td>\n<td style=\"width: 400px;\">{{vars.steps.Whois_IP.data['asn_country_code']}}</td>\n</tr>\n<tr>\n<th style=\"width: 100px;\">entities</th>\n<td style=\"width: 400px;\">{% for value in vars.steps.Whois_IP.data.entities %} {{value}}<br />{%endfor%}</td>\n</tr>\n<tr>\n<th style=\"width: 100px;\">asn</th>\n<td style=\"width: 400px;\">{{vars.steps.Whois_IP.data.asn}}</td>\n</tr>\n<tr>\n<th style=\"width: 100px;\">asn_date</th>\n<td style=\"width: 400px;\">{{vars.steps.Whois_IP.data['asn_date']}}</td>\n</tr>\n<tr>\n<th style=\"width: 100px;\">asn_description</th>\n<td style=\"width: 400px;\">{{vars.steps.Whois_IP.data['asn_description']}}</td>\n</tr>\n<tr>\n<th style=\"width: 100px;\">asn_cidr</th>\n<td style=\"width: 400px;\">{{vars.steps.Whois_IP.data['asn_cidr']}}</td>\n</tr>\n<tr>\n<th style=\"width: 100px;\">objects</th>\n<td style=\"width: 400px;\">roles: {% for value in vars.steps.Whois_IP.data.objects[0].roles %} {{value}}&nbsp;<br />{%endfor%}</td>\n</tr>\n<tr>\n<th style=\"width: 150px;\">entities</th>\n<td style=\"width: 400px;\">{% for value in vars.steps.Whois_IP.data.entities %} {{value}} {%endfor%}</td>\n</tr>\n</tbody>\n</table>\n<p><br />{% endif %}</p>"
                },
                "version": "3.1.1",
                "connector": "cyops_utilities",
                "operation": "format_richtext",
                "operationTitle": "Utils: Format as RichText",
                "step_variables": []
              },
              "status": null,
              "top": "510",
              "left": "2400",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "a915f306-1377-48b5-bd8d-b44c008230f9"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Hostname",
              "description": null,
              "arguments": {
                "name": "SSH",
                "config": "678f6a22-c999-4fd4-b18a-f8ae308c0762",
                "params": {
                  "cmd": "nslookup {{vars.input.params['indicator_value'] | ternary(vars.input.params['indicator_value'],vars.input.records[0].value) }}",
                  "allowed_exit": "-1,0",
                  "is_super_user": false
                },
                "version": "2.1.1",
                "connector": "ssh",
                "operation": "run_remote_command",
                "ignore_errors": true,
                "operationTitle": "Execute remote command",
                "step_variables": {
                  "hostname": "{{vars.result.data | regex_search('(?<=name = )(.*)')  | regex_replace('\\.(?!\\w)') | replace('/\\\\r','') | trim}}"
                }
              },
              "status": null,
              "top": "990",
              "left": "2400",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "uuid": "0df74b33-8447-4e08-87d8-b2389e88e87f"
            },
            {
              "@type": "WorkflowStep",
              "name": "Compute VT Whois",
              "description": null,
              "arguments": {
                "params": {
                  "value": " \n{% if vars.steps.Get_Reputation_from_VT.data.attributes.whois.raw[0] != None and vars.steps.Get_Reputation_from_VT.data.attributes.whois.raw[0]  %}\n<div class=\"font-size-11 ng-binding padding-bottom-sm\"><h4 style=\"background: #404142;padding: 5px;text-align: left;color: orange;background: black;\">Additional Information</h4></div>\n<div class=\"font-size-17 padding-left-sm padding-bottom-sm\"><strong>Whois Information :</strong></div>\n   \n{{vars.steps.Whois_Information_from_VT.data}}{%endif%}</div>\n"
                },
                "version": "3.1.2",
                "connector": "cyops_utilities",
                "operation": "format_richtext",
                "operationTitle": "Utils: Format as RichText",
                "step_variables": {
                  "WhoisInformationVT": "{{vars.steps.Get_Reputation_from_VT.data.whois}}"
                }
              },
              "status": null,
              "top": "840",
              "left": "2400",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "ba920c1a-7f60-405a-8506-ba02427b6af9"
            },
            {
              "@type": "WorkflowStep",
              "name": "Exit",
              "description": null,
              "arguments": {
                "params": [],
                "version": "3.2.1",
                "connector": "cyops_utilities",
                "operation": "no_op",
                "operationTitle": "Utils: No Operation",
                "step_variables": []
              },
              "status": null,
              "top": "740",
              "left": "40",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "uuid": "e8ae5d8f-f420-490c-b4a6-ed9970da94ad"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": "Indicator reputation is set as 'TBD' by 'Create and Link Indicator' utility playbook. We can ignore those indicators when triggering this PB",
              "arguments": {
                "resource": "indicators",
                "resources": [
                  "indicators"
                ],
                "step_variables": {
                  "input": {
                    "params": {
                      "indicator_value": "{{ vars.indicator_value }}"
                    },
                    "records": [
                      "{{vars.input.records[0]}}"
                    ]
                  }
                },
                "fieldbasedtrigger": {
                  "sort": [],
                  "limit": 30,
                  "logic": "AND",
                  "filters": [
                    {
                      "type": "object",
                      "field": "typeofindicator",
                      "value": "/api/3/picklists/c0beeda4-2c7a-4214-b7e5-53ba1649539c",
                      "_value": {
                        "@id": "/api/3/picklists/c0beeda4-2c7a-4214-b7e5-53ba1649539c",
                        "itemValue": "IP Address"
                      },
                      "operator": "eq"
                    },
                    {
                      "type": "object",
                      "field": "indicatorStatus",
                      "value": "/api/3/picklists/4218cb58-4de5-4eff-ad08-185d36ef9bab",
                      "_value": {
                        "@id": "/api/3/picklists/4218cb58-4de5-4eff-ad08-185d36ef9bab",
                        "itemValue": "Whitelisted"
                      },
                      "operator": "neq"
                    },
                    {
                      "logic": "OR",
                      "filters": [
                        {
                          "type": "object",
                          "field": "reputation",
                          "value": "true",
                          "_value": {
                            "@id": "true",
                            "display": "",
                            "itemValue": ""
                          },
                          "operator": "isnull"
                        },
                        {
                          "type": "object",
                          "field": "reputation",
                          "value": "/api/3/picklists/ae98ebc6-beef-4882-9980-1d88fc6d87cd",
                          "_value": {
                            "@id": "/api/3/picklists/ae98ebc6-beef-4882-9980-1d88fc6d87cd",
                            "display": "TBD",
                            "itemValue": "TBD"
                          },
                          "operator": "eq"
                        }
                      ]
                    }
                  ]
                }
              },
              "status": null,
              "top": "400",
              "left": "260",
              "stepType": "/api/3/workflow_step_types/ea155646-3821-4542-9702-b246da430a8d",
              "uuid": "69d68800-c7c3-484e-b0e8-0d36747377c2"
            },
            {
              "@type": "WorkflowStep",
              "name": "Is Dedicated Tenant Record",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "option": "Yes, Enrich at Tenant Node",
                    "step_iri": "/api/3/workflow_steps/e8ae5d8f-f420-490c-b4a6-ed9970da94ad",
                    "condition": "{{ 'tenant' in vars.input.records[0] and vars.input.records[0].tenant.isDedicated and vars.input.records[0].tenant.role != 'self' }}",
                    "step_name": "Exit"
                  },
                  {
                    "option": "No, Enrich Here",
                    "default": true,
                    "step_iri": "/api/3/workflow_steps/c1265c91-f6dd-42c1-aef8-3267fe4da659",
                    "step_name": "Match IP in Internal Subnets"
                  }
                ]
              },
              "status": null,
              "top": "560",
              "left": "260",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "uuid": "a2131b25-203d-4877-8d67-1ab49235dc0a"
            },
            {
              "@type": "WorkflowStep",
              "name": "Is Malicious",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "option": "Malicious",
                    "step_iri": "/api/3/workflow_steps/5ed210f0-e575-4e5f-b4d0-e1d50100cd8b",
                    "condition": "{{ vars.last_analysis_stats.malicious > 0 }}",
                    "step_name": "Set Malicious"
                  },
                  {
                    "option": "Safe",
                    "step_iri": "/api/3/workflow_steps/88ef889a-3249-4988-8516-8970fd64a586",
                    "condition": "{{ vars.last_analysis_stats.harmless > vars.last_analysis_stats.undetected }}",
                    "step_name": "Set Good"
                  },
                  {
                    "option": "No Reputation",
                    "default": true,
                    "step_iri": "/api/3/workflow_steps/dedcd11c-3bda-4576-a69b-f8990a9ba767",
                    "step_name": "Set No Reputation"
                  },
                  {
                    "option": "Suspicious",
                    "step_iri": "/api/3/workflow_steps/9b2a4cde-9a70-4c50-9040-36e6a650efe5",
                    "condition": "{{ vars.last_analysis_stats.suspicious > 0 }}",
                    "step_name": "Set Suspicious"
                  }
                ]
              },
              "status": null,
              "top": "430",
              "left": "2725",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "uuid": "822a7bff-e756-4581-9fb2-3c511865955c"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Whois IP -> Compute Whois Summary",
              "targetStep": "/api/3/workflow_steps/a915f306-1377-48b5-bd8d-b44c008230f9",
              "sourceStep": "/api/3/workflow_steps/b07a73b5-9188-4ef7-910b-89eba6b06a4f",
              "label": null,
              "isExecuted": false,
              "uuid": "afc4745a-e2b2-4477-8905-32c825f1e32d"
            },
            {
              "@type": "WorkflowRoute",
              "name": "ip -> Compute IP Stack Summary",
              "targetStep": "/api/3/workflow_steps/eb79f8bb-3699-4d47-8b34-de9957092f72",
              "sourceStep": "/api/3/workflow_steps/e350bca0-99b1-472d-8282-b4cc05033863",
              "label": null,
              "isExecuted": false,
              "uuid": "8b074d20-dc54-4063-8f79-a0eb4eee30af"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get Reputation from Anomali -> Compute Anomali Summary",
              "targetStep": "/api/3/workflow_steps/a09686ed-d7ce-4531-87be-44f8af4f7b1e",
              "sourceStep": "/api/3/workflow_steps/f30bb09c-ba1d-48ed-83dd-fc937f947e41",
              "label": null,
              "isExecuted": false,
              "uuid": "fd3bc9bb-5489-42be-bf6f-6e9ae3e0c455"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get Reputation from MxToolbox -> Compute MxToolbox Summary",
              "targetStep": "/api/3/workflow_steps/337de963-c807-4e4a-a5c4-cd5b74c9a8ab",
              "sourceStep": "/api/3/workflow_steps/2698e5e5-89b8-4d27-977c-d7893b3aefb3",
              "label": null,
              "isExecuted": false,
              "uuid": "bfb899af-eb9f-4e0f-a906-e3b43eb92c24"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Check CIDR -> Is IP Private",
              "targetStep": "/api/3/workflow_steps/2ff5f09b-f174-4206-95dd-9837f8d782cd",
              "sourceStep": "/api/3/workflow_steps/c1265c91-f6dd-42c1-aef8-3267fe4da659",
              "label": null,
              "isExecuted": false,
              "uuid": "54b208ba-bcbf-4540-9712-a6f6d68b8c5d"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Is IP Private -> Configuration",
              "targetStep": "/api/3/workflow_steps/8fe56d68-2662-4618-bd2f-63afb66ab0ec",
              "sourceStep": "/api/3/workflow_steps/2ff5f09b-f174-4206-95dd-9837f8d782cd",
              "label": "Public IP",
              "isExecuted": false,
              "uuid": "8c11536d-4e4b-4d97-a624-46c9078e11e8"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Configuration -> Get Reputation from AlienVault OTX",
              "targetStep": "/api/3/workflow_steps/c48fd9d8-2e58-4a7c-a9f5-4651e3cd2cac",
              "sourceStep": "/api/3/workflow_steps/8fe56d68-2662-4618-bd2f-63afb66ab0ec",
              "label": null,
              "isExecuted": false,
              "uuid": "fcc0e528-e8d9-4534-81fb-5dfd7c942cf7"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Configuration -> Get Reputation from Anomali",
              "targetStep": "/api/3/workflow_steps/f30bb09c-ba1d-48ed-83dd-fc937f947e41",
              "sourceStep": "/api/3/workflow_steps/8fe56d68-2662-4618-bd2f-63afb66ab0ec",
              "label": null,
              "isExecuted": false,
              "uuid": "dfe84b7a-d6db-4f66-85e6-ae5ea5421c6a"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Configuration -> Geo Locate IP",
              "targetStep": "/api/3/workflow_steps/e350bca0-99b1-472d-8282-b4cc05033863",
              "sourceStep": "/api/3/workflow_steps/8fe56d68-2662-4618-bd2f-63afb66ab0ec",
              "label": null,
              "isExecuted": false,
              "uuid": "d356605d-e339-40c5-873d-ab1b168291d5"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Configuration -> Whois IP",
              "targetStep": "/api/3/workflow_steps/b07a73b5-9188-4ef7-910b-89eba6b06a4f",
              "sourceStep": "/api/3/workflow_steps/8fe56d68-2662-4618-bd2f-63afb66ab0ec",
              "label": null,
              "isExecuted": false,
              "uuid": "96516505-334f-4d49-85ca-f62efcafb399"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Configuration -> Get Reputation from MxToolbox",
              "targetStep": "/api/3/workflow_steps/2698e5e5-89b8-4d27-977c-d7893b3aefb3",
              "sourceStep": "/api/3/workflow_steps/8fe56d68-2662-4618-bd2f-63afb66ab0ec",
              "label": null,
              "isExecuted": false,
              "uuid": "ae0fd460-f9cb-4605-ae32-19729cf2e039"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Is Upon Create -> Summary",
              "targetStep": "/api/3/workflow_steps/416479fc-52c9-467d-866e-7182441b855d",
              "sourceStep": "/api/3/workflow_steps/b25e951b-5d3d-4658-abb1-01f50b135b28",
              "label": "Referenced",
              "isExecuted": false,
              "uuid": "62df59fa-283a-40d7-80ca-1a0d7614e6e1"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Is Upon Create -> Update Record",
              "targetStep": "/api/3/workflow_steps/2380682f-1f1b-4fe6-9aa9-da0429094277",
              "sourceStep": "/api/3/workflow_steps/b25e951b-5d3d-4658-abb1-01f50b135b28",
              "label": "Upon Create",
              "isExecuted": false,
              "uuid": "278685f8-647d-44ab-ab25-6fe5ab92471b"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Whois Data JSON to HTML -> Compute VT Summary",
              "targetStep": "/api/3/workflow_steps/3ec77e79-987e-482b-973c-f139010c0712",
              "sourceStep": "/api/3/workflow_steps/5a61408d-b79e-4a37-a6ea-a6e9c91f573a",
              "label": null,
              "isExecuted": false,
              "uuid": "a915f12a-3139-4ea8-a032-11d21d1383f5"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get Reputation from AlienVault OTX -> Compute AV OTX Summary",
              "targetStep": "/api/3/workflow_steps/d673bca8-dd0d-45aa-aaba-1737046bb51f",
              "sourceStep": "/api/3/workflow_steps/c48fd9d8-2e58-4a7c-a9f5-4651e3cd2cac",
              "label": null,
              "isExecuted": false,
              "uuid": "57781d0c-2e36-46ee-b387-923bd2422abc"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Compute Private IP Summary -> Copy  of Set No Reputation",
              "targetStep": "/api/3/workflow_steps/8c656fed-cd7d-4f19-8f29-185313216bc3",
              "sourceStep": "/api/3/workflow_steps/68bfbb10-dbf4-4532-909c-d70a1defceb7",
              "label": null,
              "isExecuted": false,
              "uuid": "758ba53c-8697-4b43-b18f-6a87cd4081a2"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Is IP Private -> Find Hostname for Internal IP",
              "targetStep": "/api/3/workflow_steps/0df74b33-8447-4e08-87d8-b2389e88e87f",
              "sourceStep": "/api/3/workflow_steps/2ff5f09b-f174-4206-95dd-9837f8d782cd",
              "label": "Private IP",
              "isExecuted": false,
              "uuid": "d3dbe2cf-816c-452d-81bf-b9223d76bd11"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Find Hostname for Internal IP -> Compute Private IP Summary",
              "targetStep": "/api/3/workflow_steps/68bfbb10-dbf4-4532-909c-d70a1defceb7",
              "sourceStep": "/api/3/workflow_steps/0df74b33-8447-4e08-87d8-b2389e88e87f",
              "label": null,
              "isExecuted": false,
              "uuid": "14eb7db9-71b4-4b91-bf3d-b8c82f2720c1"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Configuration -> Get Reputation from VT",
              "targetStep": "/api/3/workflow_steps/5ff14e87-d6af-4173-a3ba-57e63d5d800b",
              "sourceStep": "/api/3/workflow_steps/8fe56d68-2662-4618-bd2f-63afb66ab0ec",
              "label": null,
              "isExecuted": false,
              "uuid": "04ad0f8b-876b-4389-82ea-8343d37bbb23"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get Reputation from VT -> Whois Information from VT",
              "targetStep": "/api/3/workflow_steps/5a61408d-b79e-4a37-a6ea-a6e9c91f573a",
              "sourceStep": "/api/3/workflow_steps/5ff14e87-d6af-4173-a3ba-57e63d5d800b",
              "label": null,
              "isExecuted": false,
              "uuid": "e7ad1394-84d9-4875-9324-bdcbd7000cd2"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Is Malicious -> Set Malicious",
              "targetStep": "/api/3/workflow_steps/5ed210f0-e575-4e5f-b4d0-e1d50100cd8b",
              "sourceStep": "/api/3/workflow_steps/822a7bff-e756-4581-9fb2-3c511865955c",
              "label": "Malicious",
              "isExecuted": false,
              "uuid": "b8323945-e05d-4967-9471-36a851b247e6"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Is Malicious -> Set Good",
              "targetStep": "/api/3/workflow_steps/88ef889a-3249-4988-8516-8970fd64a586",
              "sourceStep": "/api/3/workflow_steps/822a7bff-e756-4581-9fb2-3c511865955c",
              "label": "Safe",
              "isExecuted": false,
              "uuid": "b4f5ef94-720d-44cb-acfa-bb292c4aab5a"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Is Malicious -> Set No Reputation",
              "targetStep": "/api/3/workflow_steps/dedcd11c-3bda-4576-a69b-f8990a9ba767",
              "sourceStep": "/api/3/workflow_steps/822a7bff-e756-4581-9fb2-3c511865955c",
              "label": "No Reputation",
              "isExecuted": false,
              "uuid": "47af783b-495c-4745-8b09-1af8457bdb1f"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Is Malicious -> Set Suspicious",
              "targetStep": "/api/3/workflow_steps/9b2a4cde-9a70-4c50-9040-36e6a650efe5",
              "sourceStep": "/api/3/workflow_steps/822a7bff-e756-4581-9fb2-3c511865955c",
              "label": "Suspicious",
              "isExecuted": false,
              "uuid": "d570c48c-2782-4f87-953a-354165dfe674"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Compute VT Summary -> Compute VT Whois",
              "targetStep": "/api/3/workflow_steps/ba920c1a-7f60-405a-8506-ba02427b6af9",
              "sourceStep": "/api/3/workflow_steps/3ec77e79-987e-482b-973c-f139010c0712",
              "label": null,
              "isExecuted": false,
              "uuid": "b16cf86c-d415-4ef2-8f19-d5393fcd266b"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Compute AV OTX Summary -> Is Malicious",
              "targetStep": "/api/3/workflow_steps/822a7bff-e756-4581-9fb2-3c511865955c",
              "sourceStep": "/api/3/workflow_steps/d673bca8-dd0d-45aa-aaba-1737046bb51f",
              "label": null,
              "isExecuted": false,
              "uuid": "afb4f10a-5354-4a48-85b8-59006e60d97f"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Compute Anomali Summary -> Is Malicious",
              "targetStep": "/api/3/workflow_steps/822a7bff-e756-4581-9fb2-3c511865955c",
              "sourceStep": "/api/3/workflow_steps/a09686ed-d7ce-4531-87be-44f8af4f7b1e",
              "label": null,
              "isExecuted": false,
              "uuid": "d357b795-6e9a-44dd-b631-8393c8d399aa"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Compute IP Stack Summary -> Is Malicious",
              "targetStep": "/api/3/workflow_steps/822a7bff-e756-4581-9fb2-3c511865955c",
              "sourceStep": "/api/3/workflow_steps/eb79f8bb-3699-4d47-8b34-de9957092f72",
              "label": null,
              "isExecuted": false,
              "uuid": "d4b589d3-1450-4c73-ac49-3d569dd9deea"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Compute Whois Summary -> Is Malicious",
              "targetStep": "/api/3/workflow_steps/822a7bff-e756-4581-9fb2-3c511865955c",
              "sourceStep": "/api/3/workflow_steps/a915f306-1377-48b5-bd8d-b44c008230f9",
              "label": null,
              "isExecuted": false,
              "uuid": "edb54a4a-28c9-4434-86b3-2fbd42d45ea8"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Compute MxToolbox Summary -> Is Malicious",
              "targetStep": "/api/3/workflow_steps/822a7bff-e756-4581-9fb2-3c511865955c",
              "sourceStep": "/api/3/workflow_steps/337de963-c807-4e4a-a5c4-cd5b74c9a8ab",
              "label": null,
              "isExecuted": false,
              "uuid": "41b87834-e78d-4468-8495-d2fe0b58d990"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Compute VT Whois -> Is Malicious",
              "targetStep": "/api/3/workflow_steps/822a7bff-e756-4581-9fb2-3c511865955c",
              "sourceStep": "/api/3/workflow_steps/ba920c1a-7f60-405a-8506-ba02427b6af9",
              "label": null,
              "isExecuted": false,
              "uuid": "750efd54-edb5-4e32-aac6-5913f8e8b75d"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Malicious -> Enrichment Summary",
              "targetStep": "/api/3/workflow_steps/2b952c7e-7e85-4eb3-9712-44c1268781e1",
              "sourceStep": "/api/3/workflow_steps/5ed210f0-e575-4e5f-b4d0-e1d50100cd8b",
              "label": null,
              "isExecuted": false,
              "uuid": "852d238c-c182-44b0-91e4-40547b6bd95a"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Good -> Enrichment Summary",
              "targetStep": "/api/3/workflow_steps/2b952c7e-7e85-4eb3-9712-44c1268781e1",
              "sourceStep": "/api/3/workflow_steps/88ef889a-3249-4988-8516-8970fd64a586",
              "label": null,
              "isExecuted": false,
              "uuid": "8832f64a-baae-4e4d-9128-7c2e75bcd258"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set No Reputation -> Enrichment Summary",
              "targetStep": "/api/3/workflow_steps/2b952c7e-7e85-4eb3-9712-44c1268781e1",
              "sourceStep": "/api/3/workflow_steps/dedcd11c-3bda-4576-a69b-f8990a9ba767",
              "label": null,
              "isExecuted": false,
              "uuid": "01dda8f7-71a9-4717-8c8c-08860a35d314"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set Suspicious -> Enrichment Summary",
              "targetStep": "/api/3/workflow_steps/2b952c7e-7e85-4eb3-9712-44c1268781e1",
              "sourceStep": "/api/3/workflow_steps/9b2a4cde-9a70-4c50-9040-36e6a650efe5",
              "label": null,
              "isExecuted": false,
              "uuid": "7d2d3b2c-3826-4724-bdda-2056e8938286"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Set No Reputation for Private IP -> Enrichment Summary",
              "targetStep": "/api/3/workflow_steps/2b952c7e-7e85-4eb3-9712-44c1268781e1",
              "sourceStep": "/api/3/workflow_steps/8c656fed-cd7d-4f19-8f29-185313216bc3",
              "label": null,
              "isExecuted": false,
              "uuid": "acf99206-bb68-49de-899e-129c2f2c9955"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Enrichment Summary -> Is Referenced",
              "targetStep": "/api/3/workflow_steps/b25e951b-5d3d-4658-abb1-01f50b135b28",
              "sourceStep": "/api/3/workflow_steps/2b952c7e-7e85-4eb3-9712-44c1268781e1",
              "label": null,
              "isExecuted": false,
              "uuid": "8676f58a-7a0f-4462-8ff3-020f3bdf25f3"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Has Dedicated Tenant Record -> Exit",
              "targetStep": "/api/3/workflow_steps/e8ae5d8f-f420-490c-b4a6-ed9970da94ad",
              "sourceStep": "/api/3/workflow_steps/a2131b25-203d-4877-8d67-1ab49235dc0a",
              "label": "Yes, Enrich at Tenant Node",
              "isExecuted": false,
              "uuid": "50b5a654-ebf3-4252-b047-7dbe00395dc3"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Has Dedicated Tenant Record",
              "targetStep": "/api/3/workflow_steps/a2131b25-203d-4877-8d67-1ab49235dc0a",
              "sourceStep": "/api/3/workflow_steps/69d68800-c7c3-484e-b0e8-0d36747377c2",
              "label": null,
              "isExecuted": false,
              "uuid": "79c144c4-a59a-4654-a177-ae2077ba1d4f"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Has Dedicated Tenant Record -> Match IP in Internal Subnets",
              "targetStep": "/api/3/workflow_steps/c1265c91-f6dd-42c1-aef8-3267fe4da659",
              "sourceStep": "/api/3/workflow_steps/a2131b25-203d-4877-8d67-1ab49235dc0a",
              "label": "No, Enrich Here",
              "isExecuted": false,
              "uuid": "d4b30485-ec7d-473c-8100-1df85923b668"
            }
          ],
          "priority": null,
          "uuid": "3616c9cc-e077-4cbc-becd-07affce5bced",
          "id": 86,
          "createUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "createDate": 1649319945.018915,
          "modifyUser": "/api/3/people/3451141c-bac6-467c-8d72-85e0fab569ce",
          "modifyDate": 1649319945.018915,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [
            {
              "apiName": "sOARFramework",
              "name": "SOAR Framework",
              "version": "1.0.0"
            }
          ],
          "recordTags": [
            "Subroutine"
          ]
        }
      ]
    }
  ],
  "exported_tags": [
    "Subroutine"
  ]
}
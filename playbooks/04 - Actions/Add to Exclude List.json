{
    "@context": "\/api\/3\/contexts\/Workflow",
    "@type": "Workflow",
    "triggerLimit": null,
    "name": "Add to Exclude List",
    "aliasName": null,
    "tag": null,
    "description": "Add IP, Domain and URL in Exclude List Key Store",
    "isActive": true,
    "debug": false,
    "singleRecordExecution": false,
    "remoteExecutableFlag": false,
    "parameters": [],
    "synchronous": false,
    "collection": "\/api\/3\/workflow_collections\/2d150b7b-ee6b-4686-a249-3c2cfa99f657",
    "versions": [],
    "triggerStep": "\/api\/3\/workflow_steps\/25792918-9847-4f57-b3fa-32362153c2f0",
    "steps": [
        {
            "@type": "WorkflowStep",
            "name": "Add Indicator to Exclude List",
            "description": null,
            "arguments": {
                "resource": {
                    "indicatorStatus": "\/api\/3\/picklists\/4218cb58-4de5-4eff-ad08-185d36ef9bab"
                },
                "_showJson": false,
                "operation": "Append",
                "collection": "{{vars.indicatorIRI}}",
                "__recommend": [],
                "collectionType": "\/api\/3\/indicators",
                "fieldOperation": {
                    "recordTags": "Append"
                },
                "step_variables": []
            },
            "status": null,
            "top": "705",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/b593663d-7d13-40ce-a3a3-96dece928722",
            "group": null,
            "uuid": "93440c02-bafc-46a0-8c1b-3824dd5b366b"
        },
        {
            "@type": "WorkflowStep",
            "name": "Add IOC in Exclude List",
            "description": null,
            "arguments": {
                "_temp": "{% if vars.indicatorValue not in vars.keystoreValue[vars.indicatorType].excludedIOCs %}{{vars.keystoreValue[vars.indicatorType].excludedIOCs.append(vars.indicatorValue)}}{% endif %}"
            },
            "status": null,
            "top": "435",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": null,
            "uuid": "3ae17dee-619c-4cab-80eb-0d85f6df8bd5"
        },
        {
            "@type": "WorkflowStep",
            "name": "Configuration",
            "description": null,
            "arguments": {
                "indicatorIRI": "{{vars.input.records[0]['@id']}}",
                "indicatorType": "{% if 'FileHash' in  vars.input.records[0].typeofindicator.itemValue %}File Hash{% else %}{{vars.input.records[0].typeofindicator.itemValue}}{% endif %}",
                "indicatorValue": "{{vars.input.records[0].value}}"
            },
            "status": null,
            "top": "165",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": null,
            "uuid": "02dc1c0a-582d-4ef4-afc6-7486f83a760e"
        },
        {
            "@type": "WorkflowStep",
            "name": "Get Exclude List Keystore",
            "description": null,
            "arguments": {
                "query": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": [
                        {
                            "type": "primitive",
                            "field": "key",
                            "value": "sfsp-indicator-extraction-configuration",
                            "operator": "eq",
                            "_operator": "eq"
                        }
                    ],
                    "__selectFields": [
                        "jSONValue"
                    ]
                },
                "module": "keys?$limit=30",
                "checkboxFields": true,
                "step_variables": {
                    "keystoreIRI": "{{vars.steps.Get_Exclude_List_Keystore[0]['@id']}}",
                    "keystoreValue": "{{vars.steps.Get_Exclude_List_Keystore[0].jSONValue}}"
                }
            },
            "status": null,
            "top": "300",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/b593663d-7d13-40ce-a3a3-96dece928770",
            "group": null,
            "uuid": "421bdf7f-9e02-45d7-a31d-eb7ae93edfd8"
        },
        {
            "@type": "WorkflowStep",
            "name": "Start",
            "description": null,
            "arguments": {
                "route": "82586287-caa3-4092-8349-58b4b123afff",
                "title": "",
                "resources": [
                    "indicators"
                ],
                "__triggerLimit": true,
                "inputVariables": [],
                "step_variables": {
                    "input": {
                        "params": [],
                        "records": "{{vars.input.records}}"
                    }
                },
                "triggerOnSource": true,
                "displayConditions": {
                    "indicators": {
                        "sort": [],
                        "limit": 30,
                        "logic": "OR",
                        "filters": [
                            {
                                "type": "array",
                                "field": "typeofindicator",
                                "value": [
                                    "\/api\/3\/picklists\/5a5a7d42-be27-4903-858a-19909ebfa1eb",
                                    "\/api\/3\/picklists\/0162241b-f5bf-4917-a150-00e920be47bd",
                                    "\/api\/3\/picklists\/0ca054f2-d923-4992-a4a7-c516e6df281e",
                                    "\/api\/3\/picklists\/143e40b0-e643-468d-b968-a542fc85f08d",
                                    "\/api\/3\/picklists\/4ea7b083-a0af-41ea-8d7c-7ace16021722",
                                    "\/api\/3\/picklists\/c0beeda4-2c7a-4214-b7e5-53ba1649539c",
                                    "\/api\/3\/picklists\/1c4def41-b578-49a3-9063-8aa46f757c08",
                                    "\/api\/3\/picklists\/353a37b4-3eeb-43ee-aac6-64806422cfec"
                                ],
                                "module": "typeofindicator",
                                "display": "",
                                "operator": "in",
                                "template": "multiselectpicklist",
                                "OPERATOR_KEY": "$",
                                "useInOperator": true,
                                "previousOperator": "in",
                                "previousTemplate": "multiselectpicklist"
                            }
                        ]
                    }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": false,
                "showToasterMessage": {
                    "visible": false,
                    "messageVisible": true
                },
                "triggerOnReplicate": false,
                "singleRecordExecution": true
            },
            "status": null,
            "top": "30",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
            "group": null,
            "uuid": "25792918-9847-4f57-b3fa-32362153c2f0"
        },
        {
            "@type": "WorkflowStep",
            "name": "Update Excluded IOC List",
            "description": null,
            "arguments": {
                "resource": {
                    "jSONValue": "{{vars.keystoreValue}}"
                },
                "_showJson": false,
                "operation": "Append",
                "collection": "{{vars.keystoreIRI}}",
                "__recommend": [],
                "collectionType": "\/api\/3\/keys",
                "fieldOperation": {
                    "recordTags": "Append"
                },
                "step_variables": []
            },
            "status": null,
            "top": "570",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/b593663d-7d13-40ce-a3a3-96dece928722",
            "group": null,
            "uuid": "8deadff1-c6c9-4650-868e-1417a2b7e7aa"
        }
    ],
    "routes": [
        {
            "@type": "WorkflowRoute",
            "name": "Add IOC in Exclude List -> Update Excluded IOC List",
            "targetStep": "\/api\/3\/workflow_steps\/8deadff1-c6c9-4650-868e-1417a2b7e7aa",
            "sourceStep": "\/api\/3\/workflow_steps\/3ae17dee-619c-4cab-80eb-0d85f6df8bd5",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "f7c78de4-3564-4855-818a-14b06431fa57"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Configuration -> Get Excludelist Keystore",
            "targetStep": "\/api\/3\/workflow_steps\/421bdf7f-9e02-45d7-a31d-eb7ae93edfd8",
            "sourceStep": "\/api\/3\/workflow_steps\/02dc1c0a-582d-4ef4-afc6-7486f83a760e",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "42c35720-42ea-401f-ae09-6bc817077d5c"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Get Exclude List Keystore -> Get",
            "targetStep": "\/api\/3\/workflow_steps\/3ae17dee-619c-4cab-80eb-0d85f6df8bd5",
            "sourceStep": "\/api\/3\/workflow_steps\/421bdf7f-9e02-45d7-a31d-eb7ae93edfd8",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "7844ddb8-4d7c-4fb2-90af-8ea22d636987"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Start -> Configuration",
            "targetStep": "\/api\/3\/workflow_steps\/02dc1c0a-582d-4ef4-afc6-7486f83a760e",
            "sourceStep": "\/api\/3\/workflow_steps\/25792918-9847-4f57-b3fa-32362153c2f0",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "d0361b56-77c4-4fb2-b6a1-9d3fa73264d9"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Update Excluded IP List -> Add Indicator to Exclude List",
            "targetStep": "\/api\/3\/workflow_steps\/93440c02-bafc-46a0-8c1b-3824dd5b366b",
            "sourceStep": "\/api\/3\/workflow_steps\/8deadff1-c6c9-4650-868e-1417a2b7e7aa",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "9d479eb9-4fb5-468c-9c04-b401e55920cf"
        }
    ],
    "groups": [],
    "priority": null,
    "playbookOrigin": "\/api\/3\/picklists\/b6d710a9-a8ec-41ec-8817-fe9fa062fcdd",
    "isEditable": true,
    "uuid": "d3c2ddfd-a046-4737-bca7-90749483cc89",
    "owners": [],
    "isPrivate": false,
    "deletedAt": null,
    "recordTags": [
        "ManualTrigger"
    ]
}
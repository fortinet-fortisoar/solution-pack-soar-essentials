{
    "@type": "Workflow",
    "triggerLimit": null,
    "name": "Indicator (Type File - MD5) - Get Reputation",
    "aliasName": null,
    "tag": "#Subroutine",
    "description": "Get Reputation of File identified by MD5 hash",
    "isActive": true,
    "debug": false,
    "singleRecordExecution": false,
    "remoteExecutableFlag": false,
    "parameters": [
        "indicator_value"
    ],
    "synchronous": false,
    "lastModifyDate": 1646220645,
    "collection": "\/api\/3\/workflow_collections\/deaa4d19-7444-4f3a-a80e-9577436f25ef",
    "versions": [],
    "triggerStep": "\/api\/3\/workflow_steps\/b3b91030-97cc-4402-9b3f-eae663270ad9",
    "steps": [
        {
            "@type": "WorkflowStep",
            "name": "Get Reputation from AlienVault OTX",
            "description": null,
            "arguments": {
                "name": "AlienVault-OTX",
                "config": "3d96900a-f870-4ac6-94d0-00865dbaf86f",
                "params": {
                    "page": 1,
                    "limit": 5,
                    "user_text": "{{vars.indicator_value}}"
                },
                "version": "1.0.0",
                "connector": "alienvault-otx",
                "operation": "search_pulses",
                "ignore_errors": true,
                "operationTitle": "Search Pulses",
                "step_variables": {
                    "foundAVReputation": "{{ ( vars.result.data.results and vars.result.data.results|json_query(\"[*].tags[]\") | length > 0 ) | ternary(true,false) }}"
                }
            },
            "status": null,
            "top": "190",
            "left": "2725",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "uuid": "f1eb9b3c-d348-435e-9ee8-d0ccbfbb9948"
        },
        {
            "@type": "WorkflowStep",
            "name": "Update Record",
            "description": null,
            "arguments": {
                "resource": {
                    "__link": {
                        "recordTags": "{% if vars.foundAVReputation %}{{(vars.steps.Get_Reputation_from_AlienVault_OTX.data.results | json_query(\"[*].tags[]\") | unique | string).replace(\"[\",\"\").replace(\"]\",\"\").replace(\"?\",\"\").replace(\"\\'\",\"\").replace(\"#\",\"\").replace(\"\\\"\",\"\").replace(\"\/\",\"\").replace(\"*\",\"\")}}{%endif%}"
                    },
                    "reputation": "{{vars.Reputation_Type_IRI}}",
                    "description": "{{vars.steps.Enrichment_Summary.data['formatted_string']}}\n"
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "{{vars.input.records[0]['@id']}}",
                "__recommend": [],
                "collectionType": "\/api\/3\/indicators",
                "fieldOperation": {
                    "recordTags": "Append"
                },
                "step_variables": []
            },
            "status": null,
            "top": "350",
            "left": "4675",
            "stepType": "\/api\/3\/workflow_step_types\/b593663d-7d13-40ce-a3a3-96dece928722",
            "uuid": "59e92bb1-771c-4136-b17a-27ca963dfdb7"
        },
        {
            "@type": "WorkflowStep",
            "name": "Start",
            "description": "Indicator reputation is set as 'TBD' by 'Create and Link Indicator' utility playbook. We can ignore those indicators when triggering this PB",
            "arguments": {
                "resource": "indicators",
                "resources": [
                    "indicators"
                ],
                "step_variables": {
                    "input": {
                        "params": {
                            "indicator_value": "{{ vars.indicator_value }}"
                        },
                        "records": [
                            "{{vars.input.records[0]}}"
                        ]
                    }
                },
                "fieldbasedtrigger": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": [
                        {
                            "type": "object",
                            "field": "typeofindicator",
                            "value": "\/api\/3\/picklists\/0ca054f2-d923-4992-a4a7-c516e6df281e",
                            "_value": {
                                "@id": "\/api\/3\/picklists\/0ca054f2-d923-4992-a4a7-c516e6df281e",
                                "itemValue": "FileHash-MD5"
                            },
                            "operator": "eq"
                        },
                        {
                            "type": "object",
                            "field": "indicatorStatus",
                            "value": "\/api\/3\/picklists\/4218cb58-4de5-4eff-ad08-185d36ef9bab",
                            "_value": {
                                "@id": "\/api\/3\/picklists\/4218cb58-4de5-4eff-ad08-185d36ef9bab",
                                "itemValue": "Whitelisted"
                            },
                            "operator": "neq"
                        },
                        {
                            "logic": "OR",
                            "filters": [
                                {
                                    "type": "object",
                                    "field": "reputation",
                                    "value": "true",
                                    "_value": {
                                        "@id": "true",
                                        "display": "",
                                        "itemValue": ""
                                    },
                                    "operator": "isnull"
                                },
                                {
                                    "type": "object",
                                    "field": "reputation",
                                    "value": "\/api\/3\/picklists\/ae98ebc6-beef-4882-9980-1d88fc6d87cd",
                                    "_value": {
                                        "@id": "\/api\/3\/picklists\/ae98ebc6-beef-4882-9980-1d88fc6d87cd",
                                        "itemValue": "TBD"
                                    },
                                    "operator": "eq"
                                }
                            ]
                        }
                    ]
                }
            },
            "status": null,
            "top": "430",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/ea155646-3821-4542-9702-b246da430a8d",
            "uuid": "b3b91030-97cc-4402-9b3f-eae663270ad9"
        },
        {
            "@type": "WorkflowStep",
            "name": "Get File Reputation from Symantec Deepsight Intelligence",
            "description": null,
            "arguments": {
                "name": "Symantec DeepSight Intelligence",
                "config": "8582d1ad-6584-4d14-a0b4-d8571b09b8b2",
                "params": {
                    "filehash": "{{vars.indicator_value}}"
                },
                "version": "1.0.1",
                "connector": "symantec-deepsight-intelligence",
                "operation": "filehash_reputation",
                "ignore_errors": true,
                "operationTitle": "Get File Reputation",
                "step_variables": {
                    "foundDeepsightReputation": "{{ ( vars.result.data.result and vars.result.data.result.reputation != \"Unknown Reputation\" ) | ternary(true,false) }}"
                }
            },
            "status": null,
            "top": "350",
            "left": "2725",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "uuid": "aadb66ec-d386-45d6-882d-bf27a357799e"
        },
        {
            "@type": "WorkflowStep",
            "name": "Enrichment Summary",
            "description": null,
            "arguments": {
                "params": {
                    "value": "{{vars.steps.Compute_VT_Summary.data['formatted_string']}}\n\n{{vars.steps.Compute_Anomali_Summary.data['formatted_string']}}\n\n{{vars.steps.Compute_AV_OTX_Summary.data['formatted_string']}}\n\n {{vars.steps.Compute_Symantec_Summary.data['formatted_string']}}\n\n{{vars.steps.Compute_Additional_Summary.data['formatted_string']}}\n"
                },
                "version": "3.1.1",
                "connector": "cyops_utilities",
                "operation": "format_richtext",
                "operationTitle": "Utils: Format as RichText",
                "step_variables": []
            },
            "status": null,
            "top": "270",
            "left": "4025",
            "stepType": "\/api\/3\/workflow_step_types\/0109f35d-090b-4a2b-bd8a-94cbc3508562",
            "uuid": "705b1a8c-2f34-4073-9402-2f20f7a968bb"
        },
        {
            "@type": "WorkflowStep",
            "name": "Configuration",
            "description": null,
            "arguments": {
                "indicator_value": "{{vars.input.params['indicator_value'] | ternary(vars.input.params['indicator_value'],vars.input.records[0].value) }}",
                "reputation_threshold": "5",
                "foundAnomaliReputation": "false"
            },
            "status": null,
            "top": "350",
            "left": "775",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "uuid": "e12717a2-053e-41d9-9b48-e104e4135a77"
        },
        {
            "@type": "WorkflowStep",
            "name": "Compute Symantec Summary",
            "description": null,
            "arguments": {
                "params": {
                    "value": "<p>{% if vars.foundDeepsightReputation%}<\/p>\n<div class=\"font-size-17 ng-binding padding-left-sm\"><strong>Symantec Deepsight Intelligence<\/strong><\/div>\n\n<div class=\"card-container-body\" style=\"width: 200px;\">\n<div class=\"card-number padding-top-sm padding-bottom-sm\">\n <div class=\"line-height-1\"> <a href=\"https:\/\/mss.symantec.com\/PortalNextgen\/Research\/md5?Hash={{vars.indicator_value}}\" target=\"_blank\" rel=\"noopener noreferrer\"> <span class=\"card-count\">{{vars.steps.Get_File_Reputation_from_Symantec_Deepsight_Intelligence.data.result.reputation}}<\/span> <\/a>\n<div class=\"font-size-14 font-weight-normall padding-top-sm padding-bottom-sm\">Detection: {{vars.steps.Get_File_Reputation_from_Symantec_Deepsight_Intelligence.data.result.detectionName}}<\/div>\n<\/div>\n<\/div>\n<p>{% endif %}<\/p>"
                },
                "version": "3.0.3",
                "connector": "cyops_utilities",
                "operation": "format_richtext",
                "operationTitle": "Utils: Format as RichText",
                "step_variables": []
            },
            "status": null,
            "top": "350",
            "left": "3050",
            "stepType": "\/api\/3\/workflow_step_types\/0109f35d-090b-4a2b-bd8a-94cbc3508562",
            "uuid": "5dbea727-5821-4ac5-a4ef-44fe73d87f36"
        },
        {
            "@type": "WorkflowStep",
            "name": "Compute AV OTX Summary",
            "description": null,
            "arguments": {
                "params": {
                    "value": "{% if vars.foundAVReputation %}\n<div class=\"font-size-11 ng-binding padding-bottom-sm\"><h4 style=\"background: #404142;padding: 5px;text-align: left;color: orange;background: black;\">Alien Vault Summary<\/h4><\/div>\n<table style=\"width: 506px; border-color: #ffffff;\" border=\"1\">\n<tbody>\n<tr>\n<td style=\"width: 45px;font-size:16px;font-weight: normal\"><strong>Tags<\/strong><\/td>\n<td><div class=\"font-size-14 font-weight-normal\">{{(vars.steps.Get_Reputation_from_AlienVault_OTX.data.results | json_query(\"[*].tags[]\") | unique | string).replace(\"[\",\"\").replace(\"]\",\"\")}}<\/div><\/td>\n<\/tr>\n<\/tbody>\n<\/table>\n<p>{% endif %}<\/p>"
                },
                "version": "3.1.1",
                "connector": "cyops_utilities",
                "operation": "format_richtext",
                "operationTitle": "Utils: Format as RichText",
                "step_variables": []
            },
            "status": null,
            "top": "190",
            "left": "3050",
            "stepType": "\/api\/3\/workflow_step_types\/0109f35d-090b-4a2b-bd8a-94cbc3508562",
            "uuid": "03dc7b47-e36a-4643-9ef5-00881d84a001"
        },
        {
            "@type": "WorkflowStep",
            "name": "Compute Anomali Summary",
            "description": null,
            "arguments": {
                "params": {
                    "value": "<p>{% if vars.foundAnomaliReputation %}<\/p>\n<div class=\"font-size-11 ng-binding padding-bottom-sm\"><h4 style=\"background: #404142;padding: 5px;text-align: left;color: orange;background: black;\"> Anomali Threatstream Detection Summary<\/h4><\/div>\n<div class=\"card-container-body\" style=\"width: 170px;\">\n{%if vars.steps.Get_File_Reputation_from_Anomali.data.objects[0].threatscore !=0 %}\n<div class=\"card-number padding-top-sm padding-bottom-sm\" style=\" border-left: 5px solid red;background:#141b23\">\n <div class=\"line-height-1\"><a href=\"https:\/\/ui.threatstream.com\/detail\/domain\/{{vars.indicator_value}}\" target=\"_blank\" rel=\"noopener noreferrer\" class=\"font-size-8em\"> <span class=\"card-count\">{{vars.steps.Get_File_Reputation_from_Anomali.data.objects[0].threatscore}} <\/span> <\/a>\n<div class=\"font-size-14 font-weight-normall padding-top-sm padding-bottom-sm\">Severity: {{vars.steps.Get_File_Reputation_from_Anomali.data.objects[0].meta.severity}}<\/div>\n{%else%}\n<div class=\"card-number padding-top-sm padding-bottom-sm\" style=\" border-left: 5px solid red\">\n <div class=\"line-height-1\"><a href=\"https:\/\/ui.threatstream.com\/detail\/domain\/{{vars.indicator_value}}\" target=\"_blank\" rel=\"noopener noreferrer\" class=\"font-size-8em\"> <span class=\"card-count\">{{vars.steps.Get_File_Reputation_from_Anomali.data.objects[0].threatscore}} <\/span> <\/a>\n<div class=\"font-size-14 font-weight-normall padding-top-sm padding-bottom-sm\">Severity: {{vars.steps.Get_File_Reputation_from_Anomali.data.objects[0].meta.severity}}{% endif %}\n<\/div>\n\n<\/div>\n<\/div>\n<p>{% endif %}<\/p>\n"
                },
                "version": "3.1.1",
                "connector": "cyops_utilities",
                "operation": "format_richtext",
                "operationTitle": "Utils: Format as RichText",
                "step_variables": []
            },
            "status": null,
            "top": "30",
            "left": "3050",
            "stepType": "\/api\/3\/workflow_step_types\/0109f35d-090b-4a2b-bd8a-94cbc3508562",
            "uuid": "1b2dd0bf-f1aa-42a7-9150-00670d74637f"
        },
        {
            "@type": "WorkflowStep",
            "name": "Summary",
            "description": null,
            "arguments": {
                "reputation": "{{vars.Reputation_Type_Text}}",
                "reputation_iri": "{{vars.Reputation_Type_IRI}}",
                "enrichment_summary": "{{vars.steps.Enrichment_Summary.data['formatted_string']}}"
            },
            "status": null,
            "top": "190",
            "left": "4675",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "uuid": "3102c5f4-8c6f-4aca-955d-fed54f60b76d"
        },
        {
            "@type": "WorkflowStep",
            "name": "Upon Create",
            "description": null,
            "arguments": {
                "conditions": [
                    {
                        "option": "Referenced",
                        "step_iri": "\/api\/3\/workflow_steps\/3102c5f4-8c6f-4aca-955d-fed54f60b76d",
                        "condition": "{{ vars.input.params['indicator_value'] | length > 0 }}"
                    },
                    {
                        "option": "Upon Create",
                        "default": true,
                        "step_iri": "\/api\/3\/workflow_steps\/59e92bb1-771c-4136-b17a-27ca963dfdb7"
                    }
                ]
            },
            "status": null,
            "top": "270",
            "left": "4350",
            "stepType": "\/api\/3\/workflow_step_types\/12254cf5-5db7-4b1a-8cb1-3af081924b28",
            "uuid": "24c31612-d81d-4311-8791-634a0fe271d5"
        },
        {
            "@type": "WorkflowStep",
            "name": "Compute VT Summary",
            "description": null,
            "arguments": {
                "params": {
                    "value": "<div class=\"font-size-11 ng-binding padding-bottom-sm\"><h4 style=\"background: #404142;padding: 5px;text-align: left;color: orange;background: black;\"> VirusTotal Detection Summary<\/h4><\/div>\n<table style=\"border-color: #04080c;\" border=\"1\" class=\"font-normal\">\n<tr><td>\n<table style=\"color:white;font-size:11;\" >\n<tr>\n<td>\n<html>\n  <head>\n    <title>Title of the document<\/title>\n    <style>\n      span.circle {\n        background: #2f3f51;\n        border-radius: 50%;\n        -moz-border-radius: 50%;\n        -webkit-border-radius: 50%;\n        display: inline-block;\n         font-weight: bold;\n        line-height: 100px;\n        margin-right: 5px;\n        text-align: center;\n        width: 100px;\n      font-size:15px;\n     border-color: Black;\n      }\n    <\/style>\n  <\/head>\n  <body><span class=\"circle\"><i style=\"font-size:25px;color:red \">\n   {{vars.last_analysis_stats.malicious}}<\/i>\/{{(vars.last_analysis_stats.values() | list ) [0:6] | sum}}<\/span>\n  <\/body>\n<\/html>\n<\/td>\n\n<td>\n<div class=\"font-size-14 ng-binding\">Malicious<\/div>\n<div class=\"card-container-body\" style=\"width: 100px;font-size:46px;\">\n<div class=\"card-number\"; style=\"font-size:45px;  border-left: 5px solid red;background:#141b23\">{{vars.last_analysis_stats.malicious}}<\/div>\n<\/div>\n<\/td>\n<td>\n<div class=\"font-size-14 ng-binding\">Suspicious<\/div>\n<div class=\"card-container-body\" style=\"width: 100px;\">\n<div class=\"card-number\" style=\"font-size:45px;  border-left: 5px solid orange; background:#141b23\">{{vars.last_analysis_stats.suspicious}}<\/div>\n<\/div>\n<\/td>\n<td>\n<div class=\"font-size-14 ng-binding\">Harmless<\/div>\n<div class=\"card-container-body\" style=\"width: 100px;\">\n<div class=\"card-number\" style=\"font-size:45px;  border-left: 5px solid green; background:#141b23\">{{vars.last_analysis_stats.harmless}}<\/div><\/div>\n<\/td>\n<\/tr>\n<\/table>\n\n<td style=\"vertical-align:top\">\n<table style=\"background-color: #1b2430; color:white;font-size:16;\" class=\"margin-10\">\n<tr>\n<div class=\"margin-top-md\">\n<i class=\"fa fa-group margin-left-md margin-right-sm\"><\/i> Community Votes<\/div>\n\n<td style=\"width: 100px;text-align: center;background:#141b23\">\n<i class=\"\tfa fa-thumbs-o-up\" style=\"font-size:25px;color:green\"><\/i>\n<div class=\"font-size-11 ng-binding\">Harmless {{vars.community_votes.harmless}}<\/div>\n<\/td>\n<td style=\"width: 100px;text-align: center;background:#141b23\">\n<i class=\"fa fa-thumbs-o-down\" style=\"font-size:25px;color:red \"><\/i>\n<div class=\"font-size-11 ng-binding\">Malicious {{vars.community_votes.malicious}}<\/div>\n<\/td>\n<\/tr>\n<\/table>\n<\/div>\n<\/td>\n<\/tr>\n<\/table>"
                },
                "version": "3.1.1",
                "connector": "cyops_utilities",
                "operation": "format_richtext",
                "operationTitle": "Utils: Format as RichText",
                "step_variables": []
            },
            "status": null,
            "top": "510",
            "left": "1425",
            "stepType": "\/api\/3\/workflow_step_types\/0109f35d-090b-4a2b-bd8a-94cbc3508562",
            "uuid": "3a1581c5-2c13-4829-8112-1f083937b2fd"
        },
        {
            "@type": "WorkflowStep",
            "name": "Get File Reputation from Anomali",
            "description": null,
            "arguments": {
                "name": "Anomali ThreatStream",
                "config": "8827ae00-b86a-4ed4-aa2c-deae42b1d993",
                "params": {
                    "value": "{{vars.indicator_value}}",
                    "validation": false,
                    "filter_option": "Exact",
                    "record_number": "Fetch All Records"
                },
                "version": "2.0.0",
                "connector": "threatstream",
                "operation": "file_reputation",
                "ignore_errors": true,
                "operationTitle": "Get File Reputation",
                "step_variables": {
                    "foundAnomaliReputation": "{{ ( vars.result.data.objects and vars.result.data.objects | length > 0 ) | ternary(true,false) }}"
                }
            },
            "status": null,
            "top": "30",
            "left": "2725",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "uuid": "faf95542-0464-4aa2-8d10-a00562a9ec24"
        },
        {
            "@type": "WorkflowStep",
            "name": "Get File Reputation from VT",
            "description": null,
            "arguments": {
                "name": "VirusTotal",
                "config": "4a22a2c4-a1b5-4b9d-ba9b-df87a8cebce9",
                "params": {
                    "file_hash": "{{vars.indicator_value}}"
                },
                "version": "2.0.0",
                "connector": "virustotal",
                "operation": "file_reputation",
                "operationTitle": "Get File Reputation",
                "pickFromTenant": false,
                "step_variables": {
                    "tags": "{{(vars.result.data.attributes.tags  | unique | string).replace(\"(\",\"\").replace(\")\",\"\").replace(\"[\",\"\").replace(\"]\",\"\")}}",
                    "community_votes": "{{vars.result.data.attributes['total_votes']}}",
                    "sandbox_verdict": "[]",
                    "last_analysis_stats": "{{vars.result.data.attributes['last_analysis_stats']}}"
                }
            },
            "status": null,
            "top": "510",
            "left": "1100",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "uuid": "e3d545f2-642b-4cc5-8519-bc8a1de38414"
        },
        {
            "@type": "WorkflowStep",
            "name": "Is Malicious",
            "description": null,
            "arguments": {
                "conditions": [
                    {
                        "option": "Malicious",
                        "step_iri": "\/api\/3\/workflow_steps\/269e2a53-f9f5-4663-95c7-979d7196d91e",
                        "condition": "{{ vars.last_analysis_stats.malicious > 0 }}",
                        "step_name": "Set Malicious"
                    },
                    {
                        "option": "No Reputation",
                        "step_iri": "\/api\/3\/workflow_steps\/885b1709-426b-433e-b21a-ca23f3221745",
                        "condition": "{{ vars.last_analysis_stats.malicious == 0 or vars.last_analysis_stats.suspicious == 0 or vars.last_analysis_stats.harmless == 0 }}",
                        "step_name": "Set No Reputation"
                    },
                    {
                        "option": "Safe",
                        "default": true,
                        "step_iri": "\/api\/3\/workflow_steps\/27db755d-c423-4913-b1da-4436f2d76551",
                        "step_name": "Set Good"
                    },
                    {
                        "option": "Suspicious",
                        "step_iri": "\/api\/3\/workflow_steps\/a61ebdd9-e6ec-4352-8d10-46bbba344984",
                        "condition": "{{ vars.last_analysis_stats.suspicious > 0 }}",
                        "step_name": "Set Suspicious"
                    }
                ]
            },
            "status": null,
            "top": "270",
            "left": "3375",
            "stepType": "\/api\/3\/workflow_step_types\/12254cf5-5db7-4b1a-8cb1-3af081924b28",
            "uuid": "e6c0bb5e-d6c2-4ba6-9ae2-31b75517e0e2"
        },
        {
            "@type": "WorkflowStep",
            "name": "Set Suspicious",
            "description": null,
            "arguments": {
                "Reputation_Type_IRI": "{{(\"IndicatorReputation\" | picklist(\"Suspicious\"))[\"@id\"]}}",
                "Reputation_Type_Text": "Suspicious"
            },
            "status": null,
            "top": "590",
            "left": "3700",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "uuid": "a61ebdd9-e6ec-4352-8d10-46bbba344984"
        },
        {
            "@type": "WorkflowStep",
            "name": "Set No Reputation",
            "description": null,
            "arguments": {
                "Reputation_Type_IRI": "{{(\"IndicatorReputation\" | picklist(\"No Reputation Available\"))[\"@id\"]}}",
                "Reputation_Type_Text": "No Reputation Available"
            },
            "status": null,
            "top": "430",
            "left": "3700",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "uuid": "885b1709-426b-433e-b21a-ca23f3221745"
        },
        {
            "@type": "WorkflowStep",
            "name": "Set Good",
            "description": null,
            "arguments": {
                "Reputation_Type_IRI": "{{(\"IndicatorReputation\" | picklist(\"Good\"))[\"@id\"]}}",
                "Reputation_Type_Text": "Good"
            },
            "status": null,
            "top": "270",
            "left": "3700",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "uuid": "27db755d-c423-4913-b1da-4436f2d76551"
        },
        {
            "@type": "WorkflowStep",
            "name": "Set Malicious",
            "description": null,
            "arguments": {
                "Reputation_Type_IRI": "{{(\"IndicatorReputation\" | picklist(\"Malicious\"))[\"@id\"]}}",
                "Reputation_Type_Text": "Malicious"
            },
            "status": null,
            "top": "110",
            "left": "3700",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "uuid": "269e2a53-f9f5-4663-95c7-979d7196d91e"
        },
        {
            "@type": "WorkflowStep",
            "name": "Compute Basic Properties",
            "description": null,
            "arguments": {
                "params": {
                    "data": "{{vars.steps.Get_File_Reputation_from_VT.data.attributes}}",
                    "styling": true,
                    "row_fields": "['md5','sha256','sha1','magic','type_tag','type_extension','type_description']",
                    "table_style": "{ 'width':'auto','font':'10px;'}"
                },
                "version": "3.1.2",
                "connector": "cyops_utilities",
                "operation": "json_to_html",
                "operationTitle": "Utils: Convert JSON into a HTML Table",
                "step_variables": []
            },
            "status": null,
            "top": "510",
            "left": "1750",
            "stepType": "\/api\/3\/workflow_step_types\/0109f35d-090b-4a2b-bd8a-94cbc3508562",
            "uuid": "c732dddf-9e82-4f5f-9965-c70874079f68"
        },
        {
            "@type": "WorkflowStep",
            "name": "Compute Additional Summary",
            "description": null,
            "arguments": {
                "params": {
                    "value": "<div class=\"font-size-11 ng-binding padding-bottom-sm\"><h4 style=\"background: #404142;padding: 5px;text-align: left;color: orange;background: black;\"> Additional Information<\/h4><\/div>\n\n<p>{% if (vars.tags | length > 0) %}<\/p>\n<div class=\"font-size-17 margin-top-12 padding-bottom-sm padding-left-sm padding-bottom-lg\"><strong>Virustotal Tags<\/strong><\/div>\n<table style=\"width: 506px; border-color: #ffffff;\" border=\"1\">\n<tbody>\n<tr>\n<td style=\"width: 45px;font-size:16px;font-weight: normal\"><strong>Tags<\/strong><\/td>\n<td> <div class=\"font-size-14 font-weight-normal\">{{(vars.tags| string).replace(\"(\",\"\").replace(\")\",\"\")}}<\/div><\/td>\n<\/tr>\n<\/tbody>\n<\/table>\n<p>{% endif %}<\/p>\n\n<br>\n\n<div style=\"white-space:nowrap;width:auto;display: flex;gap: 10px;\">\n{%if (vars.steps.Get_File_Reputation_from_VT.data.attributes.signature_info != None and vars.steps.Get_File_Reputation_from_VT.data.attributes.signature_info)%}<div><div class=\"font-size-17 margin-top-12 padding-bottom-md padding-left-sm\"><strong>Signature Information<\/strong><\/div>\n{{vars.steps.Compute_VT_Signature_Info.data}}\n<\/div>{%endif%}\n\n{%if (vars.sandbox_verdict != None and vars.sandbox_verdict) %}\n<div><div class=\"font-size-17 margin-top-12 padding-bottom-md padding-left-sm\"><strong>Sandbox Summary<\/strong><\/div>{{vars.steps.Compute_Sandbox_Verdict_from_VT.data}}\n<\/div>{%endif%}\n<\/div>\n\n\n<div class=\"font-size-17 margin-top-12 padding-bottom-sm padding-left-sm\"><strong>File Basic Properties<\/strong><\/div>\n{{vars.steps.Compute_Basic_Properties.data}}"
                },
                "version": "3.1.2",
                "connector": "cyops_utilities",
                "operation": "format_richtext",
                "operationTitle": "Utils: Format as RichText (Markdown)",
                "step_variables": []
            },
            "status": null,
            "top": "510",
            "left": "3050",
            "stepType": "\/api\/3\/workflow_step_types\/0109f35d-090b-4a2b-bd8a-94cbc3508562",
            "uuid": "e1fcb053-8718-400e-8d9d-dbf9107fd434"
        },
        {
            "@type": "WorkflowStep",
            "name": "Compute VT Signature Info",
            "description": null,
            "arguments": {
                "when": "{{(vars.steps.Get_File_Reputation_from_VT.data.attributes.signature_info != None and vars.steps.Get_File_Reputation_from_VT.data.attributes.signature_info)}}",
                "params": {
                    "data": "{{vars.steps.Get_File_Reputation_from_VT.data.attributes.signature_info}}",
                    "styling": true,
                    "row_fields": "",
                    "table_style": "{ 'width':'auto','font':'10px;'}"
                },
                "version": "3.1.2",
                "connector": "cyops_utilities",
                "operation": "json_to_html",
                "operationTitle": "Utils: Convert JSON into a HTML Table",
                "step_variables": []
            },
            "status": null,
            "top": "510",
            "left": "2075",
            "stepType": "\/api\/3\/workflow_step_types\/0109f35d-090b-4a2b-bd8a-94cbc3508562",
            "uuid": "1e023b29-4517-4a3a-97e1-88eb53e9f15a"
        },
        {
            "@type": "WorkflowStep",
            "name": "Compute Sandbox Verdict from VT",
            "description": null,
            "arguments": {
                "when": "{{(vars.sandbox_verdict != None and vars.sandbox_verdict)}}",
                "params": {
                    "data": "{{vars.sandbox_verdict}}",
                    "styling": true,
                    "row_fields": "['sandbox_name','category','confidence']",
                    "table_style": "{ 'width':'auto','font':'10px;'}"
                },
                "version": "3.1.2",
                "connector": "cyops_utilities",
                "operation": "json_to_html",
                "ignore_errors": true,
                "operationTitle": "Utils: Convert JSON into a HTML Table",
                "step_variables": []
            },
            "status": null,
            "top": "510",
            "left": "2725",
            "stepType": "\/api\/3\/workflow_step_types\/0109f35d-090b-4a2b-bd8a-94cbc3508562",
            "uuid": "883c02a3-7f57-45cb-96ac-081e7ab02cb9"
        },
        {
            "@type": "WorkflowStep",
            "name": "sandbox_detection",
            "description": null,
            "arguments": {
                "sandbox_detection_VT": "{%if vars.steps.Get_File_Reputation_from_VT.data.attributes.sandbox_verdicts%}\n{% for key,value in vars.steps.Get_File_Reputation_from_VT.data.attributes.sandbox_verdicts.items() %}{{vars.sandbox_verdict.append(value)}}\n{%endfor%}\n{%endif%}"
            },
            "status": null,
            "top": "510",
            "left": "2400",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "uuid": "c7039147-e8ab-4981-8fc3-8e59b3dfc9d7"
        },
        {
            "@type": "WorkflowStep",
            "name": "Is Dedicated Tenant Record",
            "description": null,
            "arguments": {
                "conditions": [
                    {
                        "option": "Yes, Enrich at Tenant Node",
                        "step_iri": "\/api\/3\/workflow_steps\/9a11da9c-0a5d-47b1-8cd2-6c6b9b2a8e94",
                        "condition": "{{ 'tenant' in vars.input.records[0] and vars.input.records[0].tenant.isDedicated and vars.input.records[0].tenant.role != 'self' }}",
                        "step_name": "Exit"
                    },
                    {
                        "option": "No, Enrich Here",
                        "default": true,
                        "step_iri": "\/api\/3\/workflow_steps\/e12717a2-053e-41d9-9b48-e104e4135a77",
                        "step_name": "Configuration"
                    }
                ]
            },
            "status": null,
            "top": "430",
            "left": "450",
            "stepType": "\/api\/3\/workflow_step_types\/12254cf5-5db7-4b1a-8cb1-3af081924b28",
            "uuid": "89564c46-266c-4ed3-bb82-69ab6330a749"
        },
        {
            "@type": "WorkflowStep",
            "name": "Exit",
            "description": null,
            "arguments": {
                "params": [],
                "version": "3.2.1",
                "connector": "cyops_utilities",
                "operation": "no_op",
                "operationTitle": "Utils: No Operation",
                "step_variables": []
            },
            "status": null,
            "top": "510",
            "left": "775",
            "stepType": "\/api\/3\/workflow_step_types\/0109f35d-090b-4a2b-bd8a-94cbc3508562",
            "uuid": "9a11da9c-0a5d-47b1-8cd2-6c6b9b2a8e94"
        }
    ],
    "routes": [
        {
            "@type": "WorkflowRoute",
            "name": "Configuration -> Get File Reputation from Anomali",
            "targetStep": "\/api\/3\/workflow_steps\/faf95542-0464-4aa2-8d10-a00562a9ec24",
            "sourceStep": "\/api\/3\/workflow_steps\/e12717a2-053e-41d9-9b48-e104e4135a77",
            "label": null,
            "isExecuted": false,
            "uuid": "642ef12e-6d74-4256-a88d-b6c0087a224c"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Get File Reputation from Symantec Deepsight Intelligence -> Compute Symantec Summary",
            "targetStep": "\/api\/3\/workflow_steps\/5dbea727-5821-4ac5-a4ef-44fe73d87f36",
            "sourceStep": "\/api\/3\/workflow_steps\/aadb66ec-d386-45d6-882d-bf27a357799e",
            "label": null,
            "isExecuted": false,
            "uuid": "e942ea96-a5f0-4fc4-867c-d9cd216398d8"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Configuration -> Get Reputation from AlienVault OTX",
            "targetStep": "\/api\/3\/workflow_steps\/f1eb9b3c-d348-435e-9ee8-d0ccbfbb9948",
            "sourceStep": "\/api\/3\/workflow_steps\/e12717a2-053e-41d9-9b48-e104e4135a77",
            "label": null,
            "isExecuted": false,
            "uuid": "f8be9572-0fdc-4535-b530-060190d6136b"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Configuration -> Get File Reputation from Symantec Deepsight Intelligence",
            "targetStep": "\/api\/3\/workflow_steps\/aadb66ec-d386-45d6-882d-bf27a357799e",
            "sourceStep": "\/api\/3\/workflow_steps\/e12717a2-053e-41d9-9b48-e104e4135a77",
            "label": null,
            "isExecuted": false,
            "uuid": "b52e58d0-dd68-4c61-8a28-45f4e428a96b"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Get Reputation from AlienVault OTX -> Copy  of Compute Anomali Summary",
            "targetStep": "\/api\/3\/workflow_steps\/03dc7b47-e36a-4643-9ef5-00881d84a001",
            "sourceStep": "\/api\/3\/workflow_steps\/f1eb9b3c-d348-435e-9ee8-d0ccbfbb9948",
            "label": null,
            "isExecuted": false,
            "uuid": "b8e8f42a-3e3d-47a3-9bb9-e8baa0b50775"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Get File Reputation from Anomali -> Compute Anomali Summary",
            "targetStep": "\/api\/3\/workflow_steps\/1b2dd0bf-f1aa-42a7-9150-00670d74637f",
            "sourceStep": "\/api\/3\/workflow_steps\/faf95542-0464-4aa2-8d10-a00562a9ec24",
            "label": null,
            "isExecuted": false,
            "uuid": "6f3ca77c-1813-43c8-a498-79902aba3d5b"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Enrichment Summary -> Upon Create",
            "targetStep": "\/api\/3\/workflow_steps\/24c31612-d81d-4311-8791-634a0fe271d5",
            "sourceStep": "\/api\/3\/workflow_steps\/705b1a8c-2f34-4073-9402-2f20f7a968bb",
            "label": null,
            "isExecuted": false,
            "uuid": "568ba33d-0f7a-4cf3-8f53-0bb8f0debb01"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Upon Create -> Summary",
            "targetStep": "\/api\/3\/workflow_steps\/3102c5f4-8c6f-4aca-955d-fed54f60b76d",
            "sourceStep": "\/api\/3\/workflow_steps\/24c31612-d81d-4311-8791-634a0fe271d5",
            "label": "Referenced",
            "isExecuted": false,
            "uuid": "ddbaed6d-cc54-4685-ab34-9a5426405a09"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Upon Create -> Update Record",
            "targetStep": "\/api\/3\/workflow_steps\/59e92bb1-771c-4136-b17a-27ca963dfdb7",
            "sourceStep": "\/api\/3\/workflow_steps\/24c31612-d81d-4311-8791-634a0fe271d5",
            "label": "Upon Create",
            "isExecuted": false,
            "uuid": "9d1a3f9e-8f25-48fd-ba94-7edfd2a83a65"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Configuration -> Get File Reputation from VT",
            "targetStep": "\/api\/3\/workflow_steps\/e3d545f2-642b-4cc5-8519-bc8a1de38414",
            "sourceStep": "\/api\/3\/workflow_steps\/e12717a2-053e-41d9-9b48-e104e4135a77",
            "label": null,
            "isExecuted": false,
            "uuid": "8e4f1ba9-4254-4cef-869c-bdcecf5dc837"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Get File Reputation from VT -> Compute VT Summary",
            "targetStep": "\/api\/3\/workflow_steps\/3a1581c5-2c13-4829-8112-1f083937b2fd",
            "sourceStep": "\/api\/3\/workflow_steps\/e3d545f2-642b-4cc5-8519-bc8a1de38414",
            "label": null,
            "isExecuted": false,
            "uuid": "998cde43-2c39-4d00-8920-87bb5f3ec497"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Is Malicious -> Set Malicious",
            "targetStep": "\/api\/3\/workflow_steps\/269e2a53-f9f5-4663-95c7-979d7196d91e",
            "sourceStep": "\/api\/3\/workflow_steps\/e6c0bb5e-d6c2-4ba6-9ae2-31b75517e0e2",
            "label": "Malicious",
            "isExecuted": false,
            "uuid": "353388e6-2708-406f-822c-5452abddf6ee"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Is Malicious -> Set Good",
            "targetStep": "\/api\/3\/workflow_steps\/27db755d-c423-4913-b1da-4436f2d76551",
            "sourceStep": "\/api\/3\/workflow_steps\/e6c0bb5e-d6c2-4ba6-9ae2-31b75517e0e2",
            "label": "Safe",
            "isExecuted": false,
            "uuid": "a7d88494-c5c7-4265-9124-a2405c015071"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Is Malicious -> Set No Reputation",
            "targetStep": "\/api\/3\/workflow_steps\/885b1709-426b-433e-b21a-ca23f3221745",
            "sourceStep": "\/api\/3\/workflow_steps\/e6c0bb5e-d6c2-4ba6-9ae2-31b75517e0e2",
            "label": "No Reputation",
            "isExecuted": false,
            "uuid": "2424e12b-3b9a-4efc-87c1-9ca168e70f53"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Is Malicious -> Set Suspicious",
            "targetStep": "\/api\/3\/workflow_steps\/a61ebdd9-e6ec-4352-8d10-46bbba344984",
            "sourceStep": "\/api\/3\/workflow_steps\/e6c0bb5e-d6c2-4ba6-9ae2-31b75517e0e2",
            "label": "Suspicious",
            "isExecuted": false,
            "uuid": "8e1ab6db-0415-4c6b-ba5d-e61837e6fd1b"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Compute Anomali Summary -> Is Malicious",
            "targetStep": "\/api\/3\/workflow_steps\/e6c0bb5e-d6c2-4ba6-9ae2-31b75517e0e2",
            "sourceStep": "\/api\/3\/workflow_steps\/1b2dd0bf-f1aa-42a7-9150-00670d74637f",
            "label": null,
            "isExecuted": false,
            "uuid": "88535df7-c3b1-43d5-bf8f-dfb6f50f1a91"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Compute AV OTX Summary -> Is Malicious",
            "targetStep": "\/api\/3\/workflow_steps\/e6c0bb5e-d6c2-4ba6-9ae2-31b75517e0e2",
            "sourceStep": "\/api\/3\/workflow_steps\/03dc7b47-e36a-4643-9ef5-00881d84a001",
            "label": null,
            "isExecuted": false,
            "uuid": "9a34db48-4bc1-458d-a63a-b9c271b683e8"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Compute Symantec Summary -> Is Malicious",
            "targetStep": "\/api\/3\/workflow_steps\/e6c0bb5e-d6c2-4ba6-9ae2-31b75517e0e2",
            "sourceStep": "\/api\/3\/workflow_steps\/5dbea727-5821-4ac5-a4ef-44fe73d87f36",
            "label": null,
            "isExecuted": false,
            "uuid": "59539e79-f854-47e8-99aa-351dcafea5d1"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Set Malicious -> Enrichment Summary",
            "targetStep": "\/api\/3\/workflow_steps\/705b1a8c-2f34-4073-9402-2f20f7a968bb",
            "sourceStep": "\/api\/3\/workflow_steps\/269e2a53-f9f5-4663-95c7-979d7196d91e",
            "label": null,
            "isExecuted": false,
            "uuid": "a2eb1985-987a-4ae1-b44b-6f185f301435"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Set Good -> Enrichment Summary",
            "targetStep": "\/api\/3\/workflow_steps\/705b1a8c-2f34-4073-9402-2f20f7a968bb",
            "sourceStep": "\/api\/3\/workflow_steps\/27db755d-c423-4913-b1da-4436f2d76551",
            "label": null,
            "isExecuted": false,
            "uuid": "b08df432-0aad-4904-8c05-ac98612f5512"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Set No Reputation -> Enrichment Summary",
            "targetStep": "\/api\/3\/workflow_steps\/705b1a8c-2f34-4073-9402-2f20f7a968bb",
            "sourceStep": "\/api\/3\/workflow_steps\/885b1709-426b-433e-b21a-ca23f3221745",
            "label": null,
            "isExecuted": false,
            "uuid": "7c5071e3-bb64-4e4b-8146-a150189421ff"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Set Suspicious -> Enrichment Summary",
            "targetStep": "\/api\/3\/workflow_steps\/705b1a8c-2f34-4073-9402-2f20f7a968bb",
            "sourceStep": "\/api\/3\/workflow_steps\/a61ebdd9-e6ec-4352-8d10-46bbba344984",
            "label": null,
            "isExecuted": false,
            "uuid": "bb694522-5bb1-4e4a-aa60-fbd37dce4b0f"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Compute VT Summary -> Compute Basic Properties",
            "targetStep": "\/api\/3\/workflow_steps\/c732dddf-9e82-4f5f-9965-c70874079f68",
            "sourceStep": "\/api\/3\/workflow_steps\/3a1581c5-2c13-4829-8112-1f083937b2fd",
            "label": null,
            "isExecuted": false,
            "uuid": "b388b73a-5bf3-4182-ab80-2dbcc7497c8c"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Compute Additional Summary -> Is Malicious",
            "targetStep": "\/api\/3\/workflow_steps\/e6c0bb5e-d6c2-4ba6-9ae2-31b75517e0e2",
            "sourceStep": "\/api\/3\/workflow_steps\/e1fcb053-8718-400e-8d9d-dbf9107fd434",
            "label": null,
            "isExecuted": false,
            "uuid": "bf98b675-3e19-4854-b1d1-c390fad6f670"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Compute Basic Properties -> Compute VT Signature Info",
            "targetStep": "\/api\/3\/workflow_steps\/1e023b29-4517-4a3a-97e1-88eb53e9f15a",
            "sourceStep": "\/api\/3\/workflow_steps\/c732dddf-9e82-4f5f-9965-c70874079f68",
            "label": null,
            "isExecuted": false,
            "uuid": "90cab1ab-d776-49fa-9226-9349ab0d662e"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Compute Sandbox Verdict from VT -> Compute Additional Summary",
            "targetStep": "\/api\/3\/workflow_steps\/e1fcb053-8718-400e-8d9d-dbf9107fd434",
            "sourceStep": "\/api\/3\/workflow_steps\/883c02a3-7f57-45cb-96ac-081e7ab02cb9",
            "label": null,
            "isExecuted": false,
            "uuid": "8b651209-a026-4142-8edc-b97085aa75a9"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Compute VT Signature Info -> sandbox_detection",
            "targetStep": "\/api\/3\/workflow_steps\/c7039147-e8ab-4981-8fc3-8e59b3dfc9d7",
            "sourceStep": "\/api\/3\/workflow_steps\/1e023b29-4517-4a3a-97e1-88eb53e9f15a",
            "label": null,
            "isExecuted": false,
            "uuid": "f3437b6e-4a45-4f0b-8d57-8114afb7031b"
        },
        {
            "@type": "WorkflowRoute",
            "name": "sandbox_detection -> Compute Sandbox Verdict from VT",
            "targetStep": "\/api\/3\/workflow_steps\/883c02a3-7f57-45cb-96ac-081e7ab02cb9",
            "sourceStep": "\/api\/3\/workflow_steps\/c7039147-e8ab-4981-8fc3-8e59b3dfc9d7",
            "label": null,
            "isExecuted": false,
            "uuid": "271986f2-481e-40a8-be9c-3019be3a362d"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Has Dedicated Tenant Record -> Exit",
            "targetStep": "\/api\/3\/workflow_steps\/9a11da9c-0a5d-47b1-8cd2-6c6b9b2a8e94",
            "sourceStep": "\/api\/3\/workflow_steps\/89564c46-266c-4ed3-bb82-69ab6330a749",
            "label": "Yes, Enrich at Tenant Node",
            "isExecuted": false,
            "uuid": "27e43a95-155c-4e76-aa4e-a4960f9d5767"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Start -> Has Dedicated Tenant Record",
            "targetStep": "\/api\/3\/workflow_steps\/89564c46-266c-4ed3-bb82-69ab6330a749",
            "sourceStep": "\/api\/3\/workflow_steps\/b3b91030-97cc-4402-9b3f-eae663270ad9",
            "label": null,
            "isExecuted": false,
            "uuid": "e493f64c-9672-4d2f-8a5f-25c6598f6845"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Has Dedicated Tenant Record -> Configuration",
            "targetStep": "\/api\/3\/workflow_steps\/e12717a2-053e-41d9-9b48-e104e4135a77",
            "sourceStep": "\/api\/3\/workflow_steps\/89564c46-266c-4ed3-bb82-69ab6330a749",
            "label": "No, Enrich Here",
            "isExecuted": false,
            "uuid": "6a734cc2-eff6-4d7a-94e0-a4d2d8eb1444"
        }
    ],
    "priority": null,
    "uuid": "c0ce666f-ba81-4251-a9a3-70cbe2c8afeb",
    "owners": [],
    "isPrivate": false,
    "deletedAt": null,
    "recordTags": [
        "Subroutine",
        "FSRSolutionPack",
        "sOARFramework-1.0.0"
    ]
}